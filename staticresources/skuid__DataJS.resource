!function(a,b){var c=a.datajs||{},d=a.OData||{};"function"==typeof define&&define.amd?(define("datajs",c),define("OData",d)):(a.datajs=c,a.OData=d),c.version={major:1,minor:1,build:1};var e=function(b){return a.ActiveXObject?new a.ActiveXObject(b):null},f=function(a){return null!==a&&void 0!==a},g=function(a,b){var c,d;for(c=0,d=a.length;c<d;c++)if(a[c]===b)return!0;return!1},h=function(a,b){return void 0!==a?a:b},i=function(b){if(1===arguments.length)return void a.setTimeout(b,0);var c=Array.prototype.slice.call(arguments,1);a.setTimeout(function(){b.apply(this,c)},0)},j=function(a,b){for(var c in b)a[c]=b[c];return a},k=function(a,b){if(a){var c,d;for(c=0,d=a.length;c<d;c++)if(b(a[c]))return a[c]}return null},l=function(a){return"[object Array]"===Object.prototype.toString.call(a)},m=function(a){return"[object Date]"===Object.prototype.toString.call(a)},n=function(a){return"object"==typeof a},o=function(a){return parseInt(a,10)},p=function(a,b,c){a.hasOwnProperty(b)&&(a[c]=a[b],delete a[b])},q=function(a){throw a},r=function(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")},s=function(a,b){return void 0!==a?a:b},t=/^([^:\/?#]+:)?(\/\/[^\/?#]*)?([^?#:]+)?(\?[^#]*)?(#.*)?/,u=["scheme","authority","path","query","fragment"],v=function(a){var b={isAbsolute:!1};if(a){var c=t.exec(a);if(c){var d,e;for(d=0,e=u.length;d<e;d++)c[d+1]&&(b[u[d]]=c[d+1])}b.scheme&&(b.isAbsolute=!0)}return b},w=function(a){return"".concat(a.scheme||"",a.authority||"",a.path||"",a.query||"",a.fragment||"")},x=/^\/{0,2}(?:([^@]*)@)?([^:]+)(?::{1}(\d+))?/,y=function(a){var b=v(a),c=b.scheme,d=b.authority;if(c&&(b.scheme=c.toLowerCase(),d)){var e=x.exec(d);e&&(b.authority="//"+(e[1]?e[1]+"@":"")+e[2].toLowerCase()+(e[3]?":"+e[3]:""))}return a=w(b),a.replace(/%[0-9A-F]{2}/gi,function(a){return a.toLowerCase()})},z=function(a,b){if(!b)return a;var c=v(a);if(c.isAbsolute)return a;var d,e=v(b),f={};return c.authority?(f.authority=c.authority,d=c.path,f.query=c.query):(c.path?(d="/"===c.path.charAt(0)?c.path:A(c.path,e.path),f.query=c.query):(d=e.path,f.query=c.query||e.query),f.authority=e.authority),f.path=B(d),f.scheme=e.scheme,f.fragment=c.fragment,w(f)},A=function(a,b){var c,d="/";return b&&(c=b.lastIndexOf("/"),d=b.substring(0,c),"/"!==d.charAt(d.length-1)&&(d+="/")),d+a},B=function(a){for(var b,c="",d="";a;)0===a.indexOf("..")||0===a.indexOf(".")?a=a.replace(/^\.\.?\/?/g,""):0===a.indexOf("/..")?(a=a.replace(/^\/\..\/?/g,"/"),b=c.lastIndexOf("/"),c=-1===b?"":c.substring(0,b)):0===a.indexOf("/.")?a=a.replace(/^\/\.\/?/g,"/"):(d=a,b=a.indexOf("/",1),-1!==b&&(d=a.substring(0,b)),c+=d,a=a.replace(d,""));return c},C=function(b){var c=[];if(void 0===a.atob)c=D(b);else for(var d=a.atob(b),e=0;e<d.length;e++)c.push(d.charCodeAt(e));for(var f="",g=0;g<c.length;g++){var h=c[g];f+="0123456789ABCDEF"[h>>4],f+="0123456789ABCDEF"[15&h]}return f},D=function(a){for(var b="",c=0;c<a.length;c++){var d=E(a[c]),e="";null!==d&&(e=d.toString(2),b+=F(e))}var f=[],g=parseInt(b.length/8,10);for(c=0;c<g;c++){var h=parseInt(b.substring(8*c,8*(c+1)),2);f.push(h)}return f},E=function(a){var b=a.charCodeAt(0);return b>=65&&b<=90?b-65:b>=97&&b<=122?b-65-6:b>=48&&b<=57?b+4:"+"==a?62:"/"==a?63:null},F=function(a){for(;a.length<6;)a="0"+a;return a},G="http://",H=G+"www.w3.org/",I=H+"2000/xmlns/",J=H+"XML/1998/namespace",K=function(a){return/(^\s)|(\s$)/.test(a)},L=function(a){var b=/^\s*$/;return null===a||b.test(a)},M=function(a){for(;null!==a&&1===a.nodeType;){var b=X(a,"space",J);if("preserve"===b)return!0;if("default"===b)break;a=a.parentNode}return!1},N=function(a){var b=a.nodeName;return"xmlns"==b||0===b.indexOf("xmlns:")},O=function(a,b,c){try{a.setProperty(b,c)}catch(d){}},P=function(){var a=e("Msxml2.DOMDocument.3.0");return a&&(O(a,"ProhibitDTD",!0),O(a,"MaxElementDepth",256),O(a,"AllowDocumentFunction",!1),O(a,"AllowXsltScript",!1)),a},Q=function(){try{var a=e("Msxml2.DOMDocument.6.0");return a&&(a.async=!0),a}catch(b){return P()}},R=function(a){var b=Q();if(!b)return null;b.loadXML(a);var c=b.parseError;return 0!==c.errorCode&&S(c.reason,c.srcText,a),b},S=function(a,b,c){throw"string"==typeof a&&(a={message:a}),j(a,{srcText:b||"",errorXmlText:c||""})},T=function(b){var c,d=a.DOMParser&&new a.DOMParser;if(!d)return c=R(b),c||S("XML DOM parser not supported"),c;try{c=d.parseFromString(b,"text/xml")}catch(m){S(m,"",b)}var e=c.documentElement,f=e.namespaceURI,g=fa(e);if("parsererror"===g&&f===G+"www.mozilla.org/newlayout/xml/parsererror.xml"){var h=ba(e,G+"www.mozilla.org/newlayout/xml/parsererror.xml","sourcetext"),i=h?ha(h):"";S(ea(e)||"",i,b)}if("h3"===g&&f===H+"1999/xhtml"||ca(e,H+"1999/xhtml","h3")){for(var j="",k=[],l=e.firstChild;l;)1===l.nodeType&&(j+=ea(l)||""),k.push(l.nextSibling),l=l.firstChild||k.shift();j+=ea(e)||"",S(j,"",b)}return c},U=function(a,b){return a?a+":"+b:b},V=function(a,b){if(K(b.data)){var c=Y(a,J,"space");c||(c=na(a.ownerDocument,J,U("xml","space")),ma(a,c)),c.value="preserve"}return a.appendChild(b),a},W=function(a,b){var c,d,e=a.attributes;for(c=0,d=e.length;c<d;c++)b(e.item(c))},X=function(a,b,c){var d=Y(a,b,c);return d?ha(d):null},Y=function(a,b,c){var d=a.attributes;return d.getNamedItemNS?d.getNamedItemNS(c||null,b):d.getQualifiedItem(b,c)||null},Z=function(a,b){var c=Y(a,"base",J);return(c?z(c.value,b):b)||null},$=function(a,b){ia(a,!1,function(a){return 1===a.nodeType&&b(a),!0})},_=function(a,b,c){var d,e,f=c.split("/");for(d=0,e=f.length;d<e;d++)a=a&&ba(a,b,f[d]);return a||null},aa=function(a,b,c){var d=c.lastIndexOf("/"),e=c.substring(d+1),f=c.substring(0,d),g=f?_(a,b,f):a;return g?"@"===e.charAt(0)?Y(g,e.substring(1),b):ba(g,b,e):null},ba=function(a,b,c){return da(a,b,c,!1)},ca=function(a,b,c){if(a.getElementsByTagNameNS){var d=a.getElementsByTagNameNS(b,c);return d.length>0?d[0]:null}return da(a,b,c,!0)},da=function(a,b,c,d){var e=null;return ia(a,d,function(a){if(1===a.nodeType){var d=!b||ga(a)===b,f=!c||fa(a)===c;d&&f&&(e=a)}return null===e}),e},ea=function(a){var b,c=null,d=9===a.nodeType&&a.documentElement?a.documentElement:a,e=!1===d.ownerDocument.preserveWhiteSpace;return ia(d,!1,function(a){if(3===a.nodeType||4===a.nodeType){var f=ha(a),g=e||!L(f);g||(void 0===b&&(b=M(d)),g=b),g&&(c?c+=f:c=f)}return!0}),c},fa=function(a){return a.localName||a.baseName},ga=function(a){return a.namespaceURI||null},ha=function(a){return 1===a.nodeType?ea(a):a.nodeValue},ia=function(a,b,c){for(var d=[],e=a.firstChild,f=!0;e&&f;)(f=c(e))&&(b&&e.firstChild&&d.push(e.firstChild),e=e.nextSibling||d.shift())},ja=function(a,b,c){for(var d=a.nextSibling;d;){if(1===d.nodeType){var e=!b||ga(d)===b,f=!c||fa(d)===c;if(e&&f)return d}d=d.nextSibling}return null},ka=function(){var b=a.document.implementation;return b&&b.createDocument?b.createDocument(null,null,null):Q()},la=function(a,b){if(!l(b))return ma(a,b);var c,d;for(c=0,d=b.length;c<d;c++)b[c]&&ma(a,b[c]);return a},ma=function(a,b){if(b){if("string"==typeof b)return V(a,ra(a.ownerDocument,b));2===b.nodeType?a.setAttributeNodeNS?a.setAttributeNodeNS(b):a.setAttributeNode(b):a.appendChild(b)}return a},na=function(a,b,c,d){var e=a.createAttributeNS&&a.createAttributeNS(b,c)||a.createNode(2,c,b||void 0);return e.value=d||"",e},oa=function(a,b,c,d){var e=a.createElementNS&&a.createElementNS(b,c)||a.createNode(1,c,b||void 0);return la(e,d||[])},pa=function(a,b,c){return na(a,I,U("xmlns",c),b)},qa=function(a,b){for(var c="<c>"+b+"</c>",d=T(c),e=d.documentElement,f=("importNode"in a?a.importNode(e,!0):e),g=a.createDocumentFragment(),h=f.firstChild;h;)g.appendChild(h),h=h.nextSibling;return g},ra=function(a,b){return a.createTextNode(b)},sa=function(a,b,c,d,e){var f,g,h="",i=e.split("/"),j=ba,k=oa,l=b;for(f=0,g=i.length;f<g;f++){h=i[f],"@"===h.charAt(0)&&(h=h.substring(1),j=Y,k=na);var m=j(l,c,h);m||(m=k(a,c,U(d,h)),ma(l,m)),l=m}return l},ta=function(b){var c=a.XMLSerializer;if(c){return(new c).serializeToString(b)}if(b.xml)return b.xml;throw{message:"XML serialization unsupported"}},ua=function(a){var b,c=a.childNodes,d=c.length;if(0===d)return"";var e=a.ownerDocument,f=e.createDocumentFragment(),g=e.createElement("c");for(f.appendChild(g),b=0;b<d;b++)g.appendChild(c[b]);var h=ta(f);for(h=h.substr(3,h.length-7),b=0;b<d;b++)a.appendChild(g.childNodes[b]);return h},va=function(a,b,c){return function(){return a[b].apply(a,arguments),c}},wa=function(){this._arguments=void 0,this._done=void 0,this._fail=void 0,this._resolved=!1,this._rejected=!1};wa.prototype={then:function(a,b){return a&&(this._done?this._done.push(a):this._done=[a]),b&&(this._fail?this._fail.push(b):this._fail=[b]),this._resolved?this.resolve.apply(this,this._arguments):this._rejected&&this.reject.apply(this,this._arguments),this},resolve:function(){if(this._done){var a,b;for(a=0,b=this._done.length;a<b;a++)this._done[a].apply(null,arguments);this._done=void 0,this._resolved=!1,this._arguments=void 0}else this._resolved=!0,this._arguments=arguments},reject:function(){if(this._fail){var a,b;for(a=0,b=this._fail.length;a<b;a++)this._fail[a].apply(null,arguments);this._fail=void 0,this._rejected=!1,this._arguments=void 0}else this._rejected=!0,this._arguments=arguments},promise:function(){var a={};return a.then=va(this,"then",a),a}};var xa=function(){return a.jQuery&&a.jQuery.Deferred?new a.jQuery.Deferred:new wa},ya=function(a,b){return(a&&a.__metadata||{}).type||(b?b.type:null)},za=["Edm.String","Edm.Int32","Edm.Int64","Edm.Boolean","Edm.Double","Edm.Single","Edm.DateTime","Edm.DateTimeOffset","Edm.Time","Edm.Decimal","Edm.Guid","Edm.Byte","Edm.Int16","Edm.SByte","Edm.Binary"],Aa=["Edm.Geometry","Edm.GeometryPoint","Edm.GeometryLineString","Edm.GeometryPolygon","Edm.GeometryCollection","Edm.GeometryMultiPolygon","Edm.GeometryMultiLineString","Edm.GeometryMultiPoint"],Ba=["Edm.Geography","Edm.GeographyPoint","Edm.GeographyLineString","Edm.GeographyPolygon","Edm.GeographyCollection","Edm.GeographyMultiPolygon","Edm.GeographyMultiLineString","Edm.GeographyMultiPoint"],Ca=function(a,b){if(!a)return null;if(l(a)){var c,d,e;for(c=0,d=a.length;c<d;c++)if(e=Ca(a[c],b))return e;return null}return a.dataServices?Ca(a.dataServices.schema,b):b(a)},Da=function(a,b){return a=0===a?"":"."+Ga(a.toString(),3),b>0&&(""===a&&(a=".000"),a+=Ga(b.toString(),4)),a},Ea=function(a){if("string"==typeof a)return a;var b=Pa(a),c=Ha(a.__offset);if(b&&"Z"!==c){a=new Date(a.valueOf());var d=ub(c),e=a.getUTCHours()+d.d*d.h,f=a.getUTCMinutes()+d.d*d.m;a.setUTCHours(e,f)}else b||(c="");var g=a.getUTCFullYear(),h=a.getUTCMonth()+1,i="";g<=0&&(g=-(g-1),i="-");var j=Da(a.getUTCMilliseconds(),a.__ns);return i+Ga(g,4)+"-"+Ga(h,2)+"-"+Ga(a.getUTCDate(),2)+"T"+Ga(a.getUTCHours(),2)+":"+Ga(a.getUTCMinutes(),2)+":"+Ga(a.getUTCSeconds(),2)+j+c},Fa=function(a){var b=a.ms,c="";b<0&&(c="-",b=-b);var d=Math.floor(b/864e5);b-=864e5*d;var e=Math.floor(b/36e5);b-=36e5*e;var f=Math.floor(b/6e4);b-=6e4*f;var g=Math.floor(b/1e3);return b-=1e3*g,c+"P"+Ga(d,2)+"DT"+Ga(e,2)+"H"+Ga(f,2)+"M"+Ga(g,2)+Da(b,a.ns)+"S"},Ga=function(a,b,c){for(var d=a.toString(10);d.length<b;)c?d+="0":d="0"+d;return d},Ha=function(a){return a&&"Z"!==a&&"+00:00"!==a&&"-00:00"!==a?a:"Z"},Ia=function(a){if("string"==typeof a){var b=a.indexOf(")",10);if(0===a.indexOf("Collection(")&&b>0)return a.substring(11,b)}return null},Ja=function(a,b,c,d,e,f){return e.request(a,function(e){try{e.headers&&mb(e.headers),void 0===e.data&&204!==e.statusCode&&d.read(e,f)}catch(g){return void 0===g.request&&(g.request=a),void 0===g.response&&(g.response=e),void c(g)}b(e.data,e)},c)},Ka=function(a){return Oa(a)&&l(a.__batchRequests)},La=/Collection\((.*)\)/,Ma=function(a,b){var c=a&&a.results||a;return!!c&&Na(b)||!b&&l(c)&&!Oa(c[0])},Na=function(a){return La.test(a)},Oa=function(a){return!!a&&n(a)&&!l(a)&&!m(a)},Pa=function(a){return"Edm.DateTimeOffset"===a.__edmType||!a.__edmType&&a.__offset},Qa=function(a){if(!a&&!Oa(a))return!1;var b=a.__metadata||{},c=a.__deferred||{};return!b.type&&!!c.uri},Ra=function(a){return Oa(a)&&a.__metadata&&"uri"in a.__metadata},Sa=function(a,b){var c=a&&a.results||a;return l(c)&&!Na(b)&&Oa(c[0])},Ta=function(a){return g(Ba,a)},Ua=function(a){return g(Aa,a)},Va=function(a){if(!a&&!Oa(a))return!1;var b=a.__metadata,c=a.__mediaresource;return!b&&!!c&&!!c.media_src},Wa=function(a){return m(a)||"string"==typeof a||"number"==typeof a||"boolean"==typeof a},Xa=function(a){return g(za,a)},Ya=function(a,b){return Qa(a)?"deferred":Ra(a)?"entry":Sa(a)?"feed":b&&b.relationship?null!==a&&void 0!==a&&Sa(a)?"feed":"entry":null},Za=function(a,b){return k(a,function(a){return a.name===b})},$a=function(a,b,c){return a?Ca(b,function(b){return jb(a,b,c)}):null},_a=function(a,b){return k(a,function(a){return a.name===b})},ab=function(a,b){return $a(a,b,"complexType")},bb=function(a,b){return $a(a,b,"entityType")},cb=function(a){return Ca(a,function(a){return k(a.entityContainer,function(a){return nb(a.isDefaultEntityContainer)})})},db=function(a,b){return $a(a,b,"entityContainer")},eb=function(a,b){return k(a,function(a){return a.name===b})},fb=function(a,b){var c=null;if(a){var d=a.relationship,e=Ca(b,function(a){var b=ib(a.namespace,d),c=a.association;if(b&&c){var e,f;for(e=0,f=c.length;e<f;e++)if(c[e].name===b)return c[e]}return null});if(e){var f=e.end[0];f.role!==a.toRole&&(f=e.end[1]),c=f.type}}return c},gb=function(a,b,c){if(a){var d=a.relationship,e=Ca(c,function(a){for(var b=a.entityContainer,c=0;c<b.length;c++){var e=b[c].associationSet;if(e)for(var f=0;f<e.length;f++)if(e[f].association==d)return e[f]}return null});if(e&&e.end[0]&&e.end[1])return e.end[0].entitySet==b?e.end[1].entitySet:e.end[0].entitySet}return null},hb=function(a,b){return Ca(b,function(b){for(var c=b.entityContainer,d=0;d<c.length;d++){var e=c[d].entitySet;if(e)for(var f=0;f<e.length;f++)if(e[f].name==a)return{entitySet:e[f],containerName:c[d].name,functionImport:c[d].functionImport}}return null})},ib=function(a,b){return 0===b.indexOf(a)&&"."===b.charAt(a.length)?b.substr(a.length+1):null},jb=function(a,b,c){if(a&&b){var d=ib(b.namespace,a);if(d)return k(b[c],function(a){return a.name===d})}return null},kb=function(a,b){if(a===b)return a;for(var c=a.split("."),d=b.split("."),e=c.length>=d.length?c.length:d.length,f=0;f<e;f++){var g=c[f]&&o(c[f]),h=d[f]&&o(d[f]);if(g>h)return a;if(g<h)return b}},lb={accept:"Accept","content-type":"Content-Type",dataserviceversion:"DataServiceVersion",maxdataserviceversion:"MaxDataServiceVersion"},mb=function(a){for(var b in a){var c=b.toLowerCase(),d=lb[c];if(d&&b!==d){var e=a[b];delete a[b],a[d]=e}}},nb=function(a){return"boolean"==typeof a?a:"string"==typeof a&&"true"===a.toLowerCase()},ob=/^(-?\d{4,})-(\d{2})-(\d{2})T(\d{2}):(\d{2})(?::(\d{2}))?(?:\.(\d+))?(.*)$/,pb=function(a,b,c){var d=ob.exec(a),e=d?Ha(d[8]):null;if(!d||!b&&"Z"!==e){if(c)return null;throw{message:"Invalid date/time value"}}var f=o(d[1]);f<=0&&f++;var g=d[7],h=0;if(g){if(g.length>7){if(c)return null;throw{message:"Cannot parse date/time value to given precision."}}h=Ga(g.substring(3),4,!0),g=Ga(g.substring(0,3),3,!0),g=o(g),h=o(h)}else g=0;var i=o(d[4]),j=o(d[5]),k=o(d[6])||0;if("Z"!==e){var l=ub(e),m=-l.d;i+=l.h*m,j+=l.m*m}var n=new Date;if(n.setUTCFullYear(f,o(d[2])-1,o(d[3])),n.setUTCHours(i,j,k,g),isNaN(n.valueOf())){if(c)return null;throw{message:"Invalid date/time value"}}return b&&(n.__edmType="Edm.DateTimeOffset",n.__offset=e),h&&(n.__ns=h),n},qb=function(a,b){return pb(a,!1,b)},rb=function(a,b){return pb(a,!0,b)},sb=/^([+-])?P(?:(\d+)Y)?(?:(\d+)M)?(?:(\d+)D)?(?:T(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)(?:\.(\d+))?S)?)?/,tb=function(a){var b=sb.exec(a);if(null===b)throw{message:"Invalid duration value."};var c=b[2]||"0",d=b[3]||"0",e=o(b[4]||0),f=o(b[5]||0),g=o(b[6]||0),h=parseFloat(b[7]||0);if("0"!==c||"0"!==d)throw{message:"Unsupported duration value."};var i=b[8],j=0;if(i){if(i.length>7)throw{message:"Cannot parse duration value to given precision."};j=Ga(i.substring(3),4,!0),i=Ga(i.substring(0,3),3,!0),i=o(i),j=o(j)}else i=0;i+=1e3*h+6e4*g+36e5*f+864e5*e,"-"===b[1]&&(i=-i);var k={ms:i,__edmType:"Edm.Time"};return j&&(k.ns=j),k},ub=function(a){var b=a.substring(0,1);return b="+"===b?1:-1,{d:b,h:o(a.substring(1)),m:o(a.substring(a.indexOf(":")+1))}},vb=function(a,b,c){a.method||(a.method="GET"),a.headers?mb(a.headers):a.headers={},void 0===a.headers.Accept&&(a.headers.Accept=b.accept),f(a.data)&&void 0===a.body&&b.write(a,c),f(a.headers.MaxDataServiceVersion)||(a.headers.MaxDataServiceVersion=b.maxDataServiceVersion||"1.0")},wb=function(a,b,c){if(a&&"object"==typeof a)for(var d in a){var e=a[d],f=wb(e,d,c);f=c(d,f,b),f!==e&&(void 0===e?delete a[d]:a[d]=f)}return a},xb=function(a,b){return b("",wb(a,"",b))},yb=0,zb=function(a){return!a.method||"GET"===a.method},Ab=function(b){var c=a.document.createElement("IFRAME");c.style.display="none";var d=b.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/\</g,"&lt;"),e='<html><head><script type="text/javascript" src="'+d+'"></script></head><body></body></html>';return a.document.getElementsByTagName("BODY")[0].appendChild(c),Hb(c,e),c},Bb=function(){if(a.XMLHttpRequest)return new a.XMLHttpRequest;var b;if(a.ActiveXObject)try{return new a.ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(c){try{return new a.ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(d){b=d}}else b={message:"XMLHttpRequest not supported"};throw b},Cb=function(a){return 0===a.indexOf("http://")||0===a.indexOf("https://")||0===a.indexOf("file://")},Db=function(b){if(!Cb(b))return!0;var c=a.location,d=c.protocol+"//"+c.host+"/";return 0===b.indexOf(d)},Eb=function(b,c){try{delete a[b]}catch(d){a[b]=void 0,c===yb-1&&(yb-=1)}},Fb=function(a){return a&&(Hb(a,""),a.parentNode.removeChild(a)),null},Gb=function(a,b){var c,d,e=a.getAllResponseHeaders().split(/\r?\n/);for(c=0,d=e.length;c<d;c++)if(e[c]){var f=e[c].split(": ");b[f[0]]=f[1]}},Hb=function(a,b){var c=a.contentWindow?a.contentWindow.document:a.contentDocument.document;c.open(),c.write(b),c.close()};d.defaultHttpClient={callbackParameterName:"$callback",formatQueryString:"$format=json",enableJsonpCallback:!1,request:function(b,c,d){var e,f={},g=null,j=!1;f.abort=function(){e=Fb(e),j||(j=!0,g&&(g.abort(),g=null),d({message:"Request aborted"}))};var k,l=function(){e=Fb(e),j||(j=!0,g=null,d({message:"Request timed out"}))},m=b.requestUri,n=h(b.enableJsonpCallback,this.enableJsonpCallback),o=h(b.callbackParameterName,this.callbackParameterName),p=h(b.formatQueryString,this.formatQueryString);if(!n||Db(m)){if(g=Bb(),g.onreadystatechange=function(){if(!j&&null!==g&&4===g.readyState){var a=g.statusText,e=g.status;1223===e&&(e=204,a="No Content");var f=[];Gb(g,f);var h={requestUri:m,statusCode:e,statusText:a,headers:f,body:g.responseText};j=!0,g=null,e>=200&&e<=299?c(h):d({message:"HTTP request failed",request:b,response:h})}},g.open(b.method||"GET",m,!0,b.user,b.password),b.headers)for(k in b.headers)g.setRequestHeader(k,b.headers[k]);b.timeoutMS&&(g.timeout=b.timeoutMS,g.ontimeout=l),g.send(b.body)}else{if(!zb(b))throw{message:"Request is not local and cannot be done through JSONP."};var q=yb;yb+=1;var r,s=q.toString(),t=!1;k="handleJSONP_"+s,a[k]=function(b){if(e=Fb(e),!j){t=!0,a.clearTimeout(r),Eb(k,q),a.ActiveXObject&&(b=a.JSON.parse(a.JSON.stringify(b)));var d;d=void 0===b.d?{"Content-Type":"application/json;odata=minimalmetadata",dataServiceVersion:"3.0"}:{"Content-Type":"application/json"},i(function(){Fb(e),c({body:b,statusCode:200,headers:d})})}};var u=b.timeoutMS?b.timeoutMS:12e4;r=a.setTimeout(l,u);var v=o+"=parent."+k;this.formatQueryString&&(v+="&"+p);var w=m.indexOf("?");-1===w?m=m+"?"+v:w===m.length-1?m+=v:m=m+"&"+v,e=Ab(m)}return f}};var Ib=function(a){if(!a)return null;var b,c,d=a.split(";"),e={};for(b=1,c=d.length;b<c;b++){var f=d[b].split("=");e[r(f[0])]=f[1]}return{mediaType:r(d[0]),properties:e}},Jb=function(a){if(a){var b,c=a.mediaType;for(b in a.properties)c+=";"+b+"="+a.properties[b];return c}},Kb=function(a,b,c,d){var e={};return j(e,c),j(e,{contentType:a,dataServiceVersion:b,handler:d}),e},Lb=function(a,b,c){if(a){var d=a.headers;d[b]||(d[b]=c)}},Mb=function(a,b){if(a){var c=a.headers,d=c.DataServiceVersion;c.DataServiceVersion=d?kb(d,b):b}},Nb=function(a,b){var c=a.headers;return c&&c[b]||void 0},Ob=function(a){return Ib(Nb(a,"Content-Type"))},Pb=/^\s?(\d+\.\d+);?.*$/,Qb=function(a){var b=Nb(a,"DataServiceVersion");if(b){var c=Pb.exec(b);if(c&&c.length)return c[1]}},Rb=function(a,b){return a.accept.indexOf(b.mediaType)>=0},Sb=function(a,b,c,d){if(!c||!c.headers)return!1;var e=Ob(c),g=Qb(c)||"",h=c.body;if(!f(h))return!1;if(Rb(a,e)){var i=Kb(e,g,d,a);return i.response=c,c.data=b(a,h,i),void 0!==c.data}return!1},Tb=function(a,b,c,d){if(!c||!c.headers)return!1;var e=Ob(c),f=Qb(c);if(!e||Rb(a,e)){var g=Kb(e,f,d,a);if(g.request=c,c.body=b(a,c.data,g),void 0!==c.body)return Mb(c,g.dataServiceVersion||"1.0"),Lb(c,"Content-Type",Jb(g.contentType)),Lb(c,"MaxDataServiceVersion",a.maxDataServiceVersion),!0}return!1},Ub=function(a,b,c,d){return{accept:c,maxDataServiceVersion:d,read:function(b,c){return Sb(this,a,b,c)},write:function(a,c){return Tb(this,b,a,c)}}},Vb=function(a,b){return b},Wb=function(a,b){return f(b)?b.toString():void 0};d.textHandler=Ub(Vb,Wb,"text/plain","3.0");var Xb=G+"www.opengis.net/gml",Yb=G+"www.opengis.net/def/crs/EPSG/0/",Zb=function(a,b,c){var d={type:a};return d[b]=c,d},$b=function(a){if(l(a)&&a.length>=2){var b=a[0];a[0]=a[1],a[1]=b}return a},_b=function(a,b,c,d,e,f){var g=ac(a,c,d,e,f);return Zb(b,"coordinates",g)},ac=function(a,b,c,d,e){var f=[];return $(a,function(a){if(ga(a)===Xb){var g=fa(a);if(g!==b)g===c&&$(a,function(a){if(ga(a)===Xb){var b=d(a,e);b&&f.push(b)}});else{var h=ba(a,Xb);if(h){var i=d(h,e);i&&f.push(i)}}}}),f},bc=function(a,b){var c=ac(a,"geometryMember","geometryMembers",pc,b);return Zb("GeometryCollection","geometries",c)},cc=function(a,b){return Zb("LineString","coordinates",ic(a,b))},dc=function(a,b){return _b(a,"MultiLineString","curveMember","curveMembers",ic,b)},ec=function(a,b){return _b(a,"MultiPoint","pointMember","pointMembers",jc,b)},fc=function(a,b){return _b(a,"MultiPolygon","surfaceMember","surfaceMembers",lc,b)},gc=function(a,b){return Zb("Point","coordinates",jc(a,b))},hc=function(a,b){return Zb("Polygon","coordinates",lc(a,b))},ic=function(a,b){var c=[];return $(a,function(a){if(ga(a)===Xb){var d=fa(a);return"posList"===d?void(c=nc(a,b)):"pointProperty"===d?void c.push(kc(a,b)):"pos"===d?void c.push(oc(a,b)):void 0}}),c},jc=function(a,b){var c=ba(a,Xb,"pos");return c?oc(c,b):[]},kc=function(a,b){var c=ba(a,Xb,"Point");return c?jc(c,b):[]},lc=function(a,b){var c=[],d=!1;return $(a,function(a){if(ga(a)===Xb){var e=fa(a);return"exterior"===e?(d=!0,void c.unshift(mc(a,b))):"interior"===e?void c.push(mc(a,b)):void 0}}),!d&&c.length>0&&c.unshift([[]]),c},mc=function(a,b){var c=[];return $(a,function(a){ga(a)===Xb&&"LinearRing"===fa(a)&&(c=ic(a,b))}),c},nc=function(a,b){var c=oc(a,!1),d=c.length;if(d%2!=0)throw{message:"GML posList element has an uneven number of numeric values"};for(var e=[],f=0;f<d;f+=2){var g=c.slice(f,f+2);e.push(b?$b(g):g)}return e},oc=function(a,b){var c=[],d=ea(a);if(d)for(var e=d.length,f=0,g=0;g<=e;){if(-1!==" \t\r\n".indexOf(d.charAt(g))){var h=d.substring(f,g);h&&c.push(parseFloat(h)),f=g+1}g++}return b?$b(c):c},pc=function(a,b){var c,d=fa(a);switch(d){case"Point":c=gc;break;case"Polygon":c=hc;break;case"LineString":c=cc;break;case"MultiPoint":c=ec;break;case"MultiCurve":c=dc;break;case"MultiSurface":c=fc;break;case"MultiGeometry":c=bc;break;default:throw{message:"Unsupported element: "+d,element:a}}var e=c(a,b),f=X(a,"srsName",Xb)||X(a,"srsName");if(f){if(0!==f.indexOf(Yb))throw{message:"Unsupported srs name: "+f,element:a};var g=f.substring(Yb.length);g&&(e.crs={type:"name",properties:{name:"EPSG:"+g}})}return e},qc=function(a,b,c,d){var e;switch(c){case"Point":e=yc;break;case"LineString":e=zc;break;case"Polygon":e=Ac;break;case"MultiPoint":e=Cc;break;case"MultiLineString":e=Dc;break;case"MultiPolygon":e=Ec;break;case"GeometryCollection":e=Gc;break;default:return null}var f=e(a,b,d),g=b.crs;if(g&&"name"===g.type){var h=g.properties,i=h&&h.name;if(i&&0===i.indexOf("ESPG:")&&i.length>5){var j=i.substring(5),k=na(a,null,"srsName","gml"+j);ma(f,k)}}return f},rc=function(a,b,c){return oa(a,Xb,U("gml",b),c)},sc=function(a,b,c){var d=l(b)?b:[];return d=c?$b(d):d,rc(a,"pos",d.join(" "))},tc=function(a,b,c,d){var e=rc(a,b);if(l(c)){var f,g;for(f=0,g=c.length;f<g;f++)ma(e,sc(a,c[f],d));0===g&&ma(e,rc(a,"posList"))}return e},uc=function(a,b,c){return rc(a,"Point",sc(a,b,c))},vc=function(a,b,c){return tc(a,"LineString",b,c)},wc=function(a,b,c,d){var e=rc(a,b);if(l(c)&&c.length>0){var f=tc(a,"LinearRing",c,d);ma(e,f)}return e},xc=function(a,b,c){var d=b&&b.length,e=rc(a,"Polygon");if(l(b)&&d>0){ma(e,wc(a,"exterior",b[0],c));var f;for(f=1;f<d;f++)ma(e,wc(a,"interior",b[f],c))}return e},yc=function(a,b,c){return uc(a,b.coordinates,c)},zc=function(a,b,c){return vc(a,b.coordinates,c)},Ac=function(a,b,c){return xc(a,b.coordinates,c)},Bc=function(a,b,c,d,e,f){var g=d&&d.length,h=rc(a,b);if(l(d)&&g>0){var i,j=rc(a,c);for(i=0;i<g;i++)ma(j,e(a,d[i],f));ma(h,j)}return h},Cc=function(a,b,c){return Bc(a,"MultiPoint","pointMembers",b.coordinates,uc,c)},Dc=function(a,b,c){return Bc(a,"MultiCurve","curveMembers",b.coordinates,vc,c)},Ec=function(a,b,c){return Bc(a,"MultiSurface","surfaceMembers",b.coordinates,xc,c)},Fc=function(a,b,c){return qc(a,b,b.type,c)},Gc=function(a,b,c){return Bc(a,"MultiGeometry","geometryMembers",b.geometries,Fc,c)},Hc=G+"schemas.microsoft.com/ado/",Ic=Hc+"2007/08/dataservices",Jc=Hc+"2007/06/edmx",Kc=Ic+"/metadata",Lc=function(a,b){var c={name:fa(a),value:a.value};return c[b?"namespaceURI":"namespace"]=ga(a),c},Mc=function(a,b){var c,d,e=[],f=[],g=a.attributes;for(c=0,d=g.length;c<d;c++){var h=g[c];ga(h)!==I&&e.push(Lc(h,b))}for(var i=a.firstChild;null!=i;)1===i.nodeType&&f.push(Mc(i,b)),i=i.nextSibling;var j={name:fa(a),value:ea(a),attributes:e,children:f};return j[b?"namespaceURI":"namespace"]=ga(a),j},Nc=function(a){return ga(a)===Ic&&"element"===fa(a)},Oc=function(a,b){return{type:a,extensions:b}},Pc=function(a){if(ba(a,Xb))return"Edm.Geometry";var b=ba(a,Ic);if(!b)return"Edm.String";if(Nc(b)){var c=ja(b,Ic);if(c&&Nc(c))return"Collection()"}return null},Qc=function(a){var b=null,c=!1,d=[];return W(a,function(a){var e=ga(a),f=fa(a),g=ha(a);if(e===Kc){if("null"===f)return void(c="true"===g.toLowerCase());if("type"===f)return void(b=g)}if(e!==J&&e!==I)return void d.push(Lc(a,!0))}),{type:!b&&c?"Edm.String":b,isNull:c,extensions:d}},Rc=function(a){if(ga(a)!==Ic)return null;var b=fa(a),c=Qc(a),d=c.isNull,e=c.type,f=Oc(e,c.extensions);return{name:b,value:d?null:Sc(a,e,f),metadata:f}},Sc=function(a,b,c){b||(b=Pc(a),c.type=b);var d=Ta(b);return d||Ua(b)?Tc(a,b,d):Xa(b)?Uc(a,b):Na(b)?Wc(a,b,c):Vc(a,b,c)},Tc=function(a,b,c){var d=ba(a,Xb),e=pc(d,c);return e.__metadata={type:b},e},Uc=function(a,b){var c=ha(a)||"";switch(b){case"Edm.Boolean":return nb(c);case"Edm.Binary":case"Edm.Decimal":case"Edm.Guid":case"Edm.Int64":case"Edm.String":return c;case"Edm.Byte":case"Edm.Int16":case"Edm.Int32":case"Edm.SByte":return o(c);case"Edm.Double":case"Edm.Single":return parseFloat(c);case"Edm.Time":return tb(c);case"Edm.DateTime":return qb(c);case"Edm.DateTimeOffset":return rb(c)}return c},Vc=function(a,b,c){var d={__metadata:{type:b}};return $(a,function(a){var b=Rc(a),e=b.name;c.properties=c.properties||{},c.properties[e]=b.metadata,d[e]=b.value}),d},Wc=function(a,b,c){var d=[],e=c.elements=[],f=Ia(b);return $(a,function(a){if(Nc(a)){var b=Qc(a),c=b.extensions,g=b.type||f,h=Oc(g,c),i=Sc(a,g,h);d.push(i),e.push(h)}}),{__metadata:{type:"Collection()"===b?null:b},results:d}},Xc=function(a,b){if(ga(a)===Ic){b=Z(a,b);var c=fa(a);if("links"===c)return Yc(a,b);if("uri"===c)return Zc(a,b)}},Yc=function(a,b){var c=[];return $(a,function(a){"uri"===fa(a)&&ga(a)===Ic&&c.push(Zc(a,b))}),{results:c}},Zc=function(a,b){var c=ea(a)||"";return{uri:z(c,b)}},$c=function(a,b){return"Edm.Geometry"===b||"Edm.Geography"===b?a&&a.type:"Edm.GeometryPoint"===b||"Edm.GeographyPoint"===b?"Point":"Edm.GeometryLineString"===b||"Edm.GeographyLineString"===b?"LineString":"Edm.GeometryPolygon"===b||"Edm.GeographyPolygon"===b?"Polygon":"Edm.GeometryCollection"===b||"Edm.GeographyCollection"===b?"GeometryCollection":"Edm.GeometryMultiPolygon"===b||"Edm.GeographyMultiPolygon"===b?"MultiPolygon":"Edm.GeometryMultiLineString"===b||"Edm.GeographyMultiLineString"===b?"MultiLineString":"Edm.GeometryMultiPoint"===b||"Edm.GeographyMultiPoint"===b?"MultiPoint":null},_c=function(a,b,c){return oa(a,Kc,U("m",b),c)},ad=function(a,b,c){return na(a,Kc,U("m",b),c)},bd=function(a,b,c){return oa(a,Ic,U("d",b),c)},cd=function(a,b){return"Edm.DateTime"===b||"Edm.DateTimeOffset"===b||m(a)?Ea(a):"Edm.Time"===b?Fa(a):a.toString()},dd=function(a,b){return{element:a,dsv:b}},ed=function(a,b,c,d){var e=c?ad(a,"type",c):null,f=bd(a,b,e);return la(f,d)},fd=function(a,b,c,d){var e=cd(c,d),f=ed(a,b,d,e);return dd(f,"1.0")},gd=function(a,b,c,d){var e=ad(a,"null","true"),f=ed(a,b,c,e),g=ab(c,d)?"2.0":"1.0";return dd(f,g)},hd=function(a,b,c,d,e,f,g){var h=Ia(d),i=l(c)?c:c.results,j=d?{type:h}:{};j.properties=e.properties;var k,m,n=ed(a,b,h?d:null);for(k=0,m=i.length;k<m;k++){var o=i[k],p=kd(a,"element",o,j,f,g);ma(n,p.element)}return dd(n,"3.0")},id=function(a,b,c,d,e,f,g){var h=ed(a,b,d),i=e.properties||{},j=ab(d,g)||{},k="1.0";for(var l in c)if("__metadata"!==l){var m=c[l],n=Za(j.property,l),o=i[l]||{},p=kd(a,l,m,o,n,g);k=kb(k,p.dsv),ma(h,p.element)}return dd(h,k)},jd=function(a,b,c,d,e){var f=$c(c,d),g=qc(a,c,f,e),h=ed(a,b,d,g);return dd(h,"3.0")},kd=function(a,b,c,d,e,f){var g=ya(c,d);if(Wa(c))return fd(a,b,c,g||"Edm.String");var h=Ta(g);return h||Ua(g)?jd(a,b,c,g,h):Ma(c,g)?hd(a,b,c,g,d,e,f):Va(c)?null:null!==Ya(c,e)?null:null===c?gd(a,b,g):id(a,b,c,g,d,0,f)},ld=function(a){if(a&&n(a)){var b=ka();return ma(b,bd(b,"uri",a.uri))}},md=function(a,b){if(b){var c=T(b),d=ba(c);if(d)return Xc(d)}},nd=function(a,b,c){var d=c.contentType=c.contentType||Ib("application/xml");if(d&&"application/xml"===d.mediaType)return ta(ld(b))};d.xmlHandler=Ub(md,nd,"application/xml","3.0");var od=H+"2005/Atom",pd=H+"2007/app",qd=["application/atom+xml","application/atomsvc+xml","application/xml"],rd=qd[0],sd=[od,pd,J,I],td={SyndicationAuthorEmail:"author/email",SyndicationAuthorName:"author/name",SyndicationAuthorUri:"author/uri",SyndicationContributorEmail:"contributor/email",SyndicationContributorName:"contributor/name",SyndicationContributorUri:"contributor/uri",SyndicationPublished:"published",SyndicationRights:"rights",SyndicationSummary:"summary",SyndicationTitle:"title",SyndicationUpdated:"updated"},ud=function(a){return td[a]||a},vd=function(a){return!g(sd,a)},wd=function(a,b,c,d,e){e=e||"";var f=a["FC_TargetPath"+e];if(!f)return null;var g=a["FC_SourcePath"+e],h=ud(f),i=d?d+(g?"/"+g:""):g,j=i&&Kd(c,b,i),k=a["FC_NsUri"+e]||null,l=a["FC_NsPrefix"+e]||null,m=a["FC_KeepInContent"+e]||"";return f!==h&&(k=od,l="a"),{contentKind:a["FC_ContentKind"+e],keepInContent:"true"===m.toLowerCase(),nsPrefix:l,nsURI:k,propertyPath:i,propertyType:j,entryPath:h}},xd=function(a,b,c){for(var d=[];a;){var e=(a.FC_SourcePath,wd(a,a,b));e&&c(e);var f,g,h=a.property||[];for(f=0,g=h.length;f<g;f++)for(var i=h[f],j=0,k="";e=wd(i,a,b,i.name,k);)c(e),j++,k="_"+j;a=bb(a.baseType,b)}return d},yd=function(a){var b=[];return W(a,function(a){var c=ga(a);vd(c)&&b.push(Lc(a,!0))}),b},zd=function(a){return Mc(a,!0)},Ad=function(a,b,c){var d=ga(a),e=fa(a);if(d===pd&&"service"===e)return Xd(a,b);if(d===od){if("feed"===e)return Ed(a,b,c);if("entry"===e)return Ld(a,b,c)}},Bd=function(a,b){var c=[],d={extensions:c};return W(a,function(e){var f=fa(e),g=ga(e),h=ha(e);if(null===g){if("title"===f||"metadata"===f)return void(d[f]=h);if("target"===f)return void(d.target=z(h,Z(a,b)))}vd(g)&&c.push(Lc(e,!0))}),d},Cd=function(a,b,c){(c.actions=c.actions||[]).push(Bd(a,b))},Dd=function(a,b,c){(c.functions=c.functions||[]).push(Bd(a,b))},Ed=function(a,b,c){var d=yd(a),e={feed_extensions:d},f=[],g={__metadata:e,
results:f};return b=Z(a,b),$(a,function(a){var h=ga(a),i=fa(a);if(h===Kc){if("count"===i)return void(g.__count=parseInt(ea(a),10));if("action"===i)return void Cd(a,b,e);if("function"===i)return void Dd(a,b,e)}return vd(h)?void d.push(Mc(a)):"entry"===i?void f.push(Ld(a,b,c)):"link"===i?void Fd(a,g,b):"id"===i?(e.uri=z(ea(a),b),void(e.uri_extensions=yd(a))):"title"===i?(e.title=ea(a)||"",void(e.title_extensions=yd(a))):void 0}),g},Fd=function(a,b,c){var d=Gd(a,c),e=d.href,f=d.rel,g=d.extensions,h=b.__metadata;return"next"===f?(b.__next=e,void(h.next_extensions=g)):"self"===f?(h.self=e,void(h.self_extensions=g)):void 0},Gd=function(a,b){b=Z(a,b);var c=[],d={extensions:c,baseURI:b};if(W(a,function(a){var e=ga(a),f=fa(a),g=a.value;return"href"===f?void(d.href=z(g,b)):"type"===f||"rel"===f?void(d[f]=g):void(vd(e)&&c.push(Lc(a,!0)))}),!d.href)throw{error:"href attribute missing on link element",element:a};return d},Hd=function(a,b){if(-1===a.indexOf("/"))return b[a];var c,d,e=a.split("/");for(c=0,d=e.length;c<d;c++){if(null===b)return;if(void 0===(b=b[e[c]]))return b}return b},Id=function(a,b,c,d){var e;if(-1===a.indexOf("/"))b[a]=c,e=a;else{var f,g,h=a.split("/");for(f=0,g=h.length-1;f<g;f++){var i=b[h[f]];if(void 0===i)i={},b[h[f]]=i;else if(null===i)return;b=i}e=h[f],b[e]=c}if(d){var j=b.__metadata=b.__metadata||{},k=j.properties=j.properties||{};(k[e]=k[e]||{}).type=d}},Jd=function(a,b,c){var d=a.propertyPath;if(!a.keepInContent&&null!==Hd(d,c)){var e=aa(b,a.nsURI,a.entryPath);if(e){var f,g=a.propertyType;f="xhtml"===a.contentKind?ua(e):Uc(e,g||"Edm.String"),Id(d,c,f,g)}}},Kd=function(a,b,c){for(var d,e,f=c.split("/");b;){var g=b;for(d=0,e=f.length;d<e;d++){var h=g.property;if(!h)break;var i=Za(h,f[d]);if(!i)break;var j=i.type;if(!j||Xa(j))return j||null;if(!(g=ab(j,a)))return null}b=bb(b.baseType,a)}return null},Ld=function(a,b,c){var d={},e={__metadata:d},f=X(a,"etag",Kc);f&&(d.etag=f),b=Z(a,b),$(a,function(a){var f=ga(a),g=fa(a);if(f!==od){if(f===Kc){if("properties"===g)return void Wd(a,e,d);if("action"===g)return void Cd(a,b,d);if("function"===g)return void Dd(a,b,d)}}else{if("id"===g)return void Md(a,d,b);if("category"===g)return void Nd(a,d);if("content"===g)return void Od(a,e,d,b);if("link"===g)return void Pd(a,e,d,b,c)}});var g=bb(d.type,c);return xd(g,c,function(b){Jd(b,a,e)}),e},Md=function(a,b,c){b.uri=z(ea(a),Z(a,c)),b.uri_extensions=yd(a)},Nd=function(a,b){if(X(a,"scheme")===Ic+"/scheme"){if(b.type)throw{message:"Invalid AtomPub document: multiple category elements defining the entry type were encounterd withing an entry",element:a};var c=[];W(a,function(a){var b=ga(a),d=fa(a);if(!b)return void("scheme"!==d&&"term"!==d&&c.push(Lc(a,!0)));vd(b)&&c.push(Lc(a,!0))}),b.type=X(a,"term"),b.type_extensions=c}},Od=function(a,b,c,d){var e=X(a,"src"),f=X(a,"type");if(e){if(!f)throw{message:"Invalid AtomPub document: content element must specify the type attribute if the src attribute is also specified",element:a};c.media_src=z(e,Z(a,d)),c.content_type=f}$(a,function(d){if(e)throw{message:"Invalid AtomPub document: content element must not have child elements if the src attribute is specified",element:a};ga(d)===Kc&&"properties"===fa(d)&&Wd(d,b,c)})},Pd=function(a,b,c,d,e){var f=Gd(a,d),g=f.rel,h=f.href,i=f.extensions;return"self"===g?(c.self=h,void(c.self_link_extensions=i)):"edit"===g?(c.edit=h,void(c.edit_link_extensions=i)):"edit-media"===g?(c.edit_media=f.href,c.edit_media_extensions=i,void Vd(f,c)):0===g.indexOf(Ic+"/edit-media/")?void Sd(f,b,c):0===g.indexOf(Ic+"/mediaresource/")?void Td(f,b,c):0===g.indexOf(Ic+"/related/")?void Rd(a,f,b,c,e):0===g.indexOf(Ic+"/relatedlinks/")?void Qd(f,c):void 0},Qd=function(a,b){var c=a.rel.substring((Ic+"/relatedlinks/").length);b.properties=b.properties||{};var d=b.properties[c]=b.properties[c]||{};d.associationuri=a.href,d.associationuri_extensions=a.extensions},Rd=function(a,b,c,d,e){var f,g=ba(a,Kc,"inline");if(g){var h=ba(g),i=Z(g,b.baseURI);f=h?Ad(h,i,e):null}else f={__deferred:{uri:b.href}};var j=b.rel.substring((Ic+"/related/").length);c[j]=f,d.properties=d.properties||{},(d.properties[j]=d.properties[j]||{}).extensions=b.extensions},Sd=function(a,b,c){var d=a.rel.substring((Ic+"/edit-media/").length),e=Ud(d,b,c),f=e.value,g=e.metadata,h=a.href;f.edit_media=h,f.content_type=a.type,g.edit_media_extensions=a.extensions,f.media_src=f.media_src||h,g.media_src_extensions=g.media_src_extensions||[],Vd(a,f)},Td=function(a,b,c){var d=a.rel.substring((Ic+"/mediaresource/").length),e=Ud(d,b,c),f=e.value,g=e.metadata;f.media_src=a.href,g.media_src_extensions=a.extensions,f.content_type=a.type},Ud=function(a,b,c){c.properties=c.properties||{};var d=c.properties[a],e=b[a]&&b[a].__mediaresource;return e||(e={},b[a]={__mediaresource:e},c.properties[a]=d={}),{value:e,metadata:d}},Vd=function(a,b){var c,d,e=a.extensions;for(c=0,d=e.length;c<d;c++)if(e[c].namespaceURI===Kc&&"etag"===e[c].name)return b.media_etag=e[c].value,void e.splice(c,1)},Wd=function(a,b,c){$(a,function(a){var d=Rc(a);if(d){var e=d.name;(c.properties=c.properties||{})[e]=d.metadata,b[e]=d.value}})},Xd=function(a,b){var c=[],d=[];if(b=Z(a,b),$(a,function(a){if(ga(a)===pd&&"workspace"===fa(a))return void c.push(Yd(a,b));d.push(Mc(a))}),0===c.length)throw{message:"Invalid AtomPub service document: No workspace element found.",element:a};return{workspaces:c,extensions:d}},Yd=function(a,b){var c,d=[],e=[];return b=Z(a,b),$(a,function(a){var f=ga(a),g=fa(a);if(f===od&&"title"===g){if(void 0!==c)throw{message:"Invalid AtomPub service document: workspace has more than one child title element",element:a};return void(c=ea(a))}if(f===pd)return void("collection"===g&&d.push(Zd(a,b)));e.push(zd(a))}),{title:c||"",collections:d,extensions:e}},Zd=function(a,b){var c=X(a,"href");if(!c)throw{message:"Invalid AtomPub service document: collection has no href attribute",element:a};b=Z(a,b),c=z(c,Z(a,b));var d,e=[];if($(a,function(b){var c=ga(b),f=fa(b);if(c!==od)c!==pd&&e.push(zd(a));else if("title"===f){if(void 0!==d)throw{message:"Invalid AtomPub service document: collection has more than one child title element",element:b};d=ea(b)}}),!d)throw{message:"Invalid AtomPub service document: collection has no title element",element:a};return{title:d,href:c,extensions:e}},$d=function(a,b,c){return oa(a,od,U("a",b),c)},_d=function(a,b,c){return na(a,null,b,c)},ae=function(a){if(a.childNodes.length>0)return!1;var b,c,d=!0,e=a.attributes;for(b=0,c=e.length;b<c&&d;b++){var f=e[b];d=d&&N(f)||ga(f)==Kc&&"type"===fa(f)}return d},be=function(a,b,c,d,e){var f=null,g=null,h=null,i="";"deferred"!==c?(f=_d(a,"type","application/atom+xml;type="+c),g=_c(a,"inline"),d&&(i=d.__metadata&&d.__metadata.uri||"",h=fe(a,d,e)||ee(a,d,e),ma(g,h.element))):i=d.__deferred.uri;var j=$d(a,"link",[_d(a,"href",i),_d(a,"rel",z(b,Ic+"/related/")),f,g]);return dd(j,h?h.dsv:"1.0")},ce=function(a,b,c,d,e,f){if(Va(c))return null;var g=kd(a,b,c,d,e,f);if(!g){var h=Ya(c,e);g=be(a,b,h,c,f)}return g},de=function(a,b,c,d){var e,f=_(c,Ic,d.propertyPath),g=f&&Y(f,"null",Kc),h="1.0";if(g&&"true"===g.value)return h;if(f&&(e=ea(f)||"",!d.keepInContent)){h="2.0";var i=f.parentNode,j=i;for(i.removeChild(f);j!==c&&ae(j);)i=j.parentNode,i.removeChild(j),j=i}var k=sa(a,b,d.nsURI,d.nsPrefix,d.entryPath);if(2===k.nodeType)return k.value=e,h;var l=d.contentKind;return la(k,[l&&na(a,null,"type",l),"xhtml"===l?qa(a,e):e]),h},ee=function(a,b,c){var d=b.__metadata||{},e=d.properties||{},f=d.etag,g=d.uri,h=d.type,i=bb(h,c),j=_c(a,"properties"),k=$d(a,"entry",[$d(a,"author",$d(a,"name")),f&&ad(a,"etag",f),g&&$d(a,"id",g),h&&$d(a,"category",[_d(a,"term",h),_d(a,"scheme",Ic+"/scheme")]),$d(a,"content",[_d(a,"type","application/xml"),j])]),l="1.0";for(var m in b)if("__metadata"!==m){var n=e[m]||{},o=i&&(Za(i.property,m)||Za(i.navigationProperty,m)),p=ce(a,m,b[m],n,o,c);if(p){var q=p.element,r=ga(q)===od?k:j;ma(r,q),l=kb(l,p.dsv)}}return xd(i,c,function(b){var c=de(a,k,j,b);l=kb(l,c)}),dd(k,l)},fe=function(a,b,c){var d=l(b)?b:b.results;if(!d)return null;var e,f,g="1.0",h=$d(a,"feed");for(e=0,f=d.length;e<f;e++){var i=ee(a,d[e],c);ma(h,i.element),g=kb(g,i.dsv)}return dd(h,g)},ge=function(a,b){if(a){var c=Sa(a)&&fe||n(a)&&ee;if(c){var d=ka(),e=c(d,a,b);if(e){var f=e.element;return la(f,[pa(d,Kc,"m"),pa(d,Ic,"d")]),dd(ma(d,f),e.dsv)}}}return null},he=function(a,b,c){if(b){var d=T(b),e=ba(d);if(e)return Ad(e,null,c.metadata)}},ie=function(a,b,c){var d=c.contentType=c.contentType||Ib(rd);if(d&&d.mediaType===rd){var e=ge(b,c.metadata);if(e)return c.dataServiceVersion=kb(c.dataServiceVersion||"1.0",e.dsv),ta(e.element)}};d.atomHandler=Ub(he,ie,qd.join(","),"3.0");var je=function(a,b,c,d){return{attributes:a,elements:b,text:c||!1,ns:d}},ke={elements:{Annotations:je(["Target","Qualifier"],["TypeAnnotation*","ValueAnnotation*"]),Association:je(["Name"],["End*","ReferentialConstraint","TypeAnnotation*","ValueAnnotation*"]),AssociationSet:je(["Name","Association"],["End*","TypeAnnotation*","ValueAnnotation*"]),Binary:je(null,null,!0),Bool:je(null,null,!0),Collection:je(null,["String*","Int*","Float*","Decimal*","Bool*","DateTime*","DateTimeOffset*","Guid*","Binary*","Time*","Collection*","Record*"]),CollectionType:je(["ElementType","Nullable","DefaultValue","MaxLength","FixedLength","Precision","Scale","Unicode","Collation","SRID"],["CollectionType","ReferenceType","RowType","TypeRef"]),ComplexType:je(["Name","BaseType","Abstract"],["Property*","TypeAnnotation*","ValueAnnotation*"]),DateTime:je(null,null,!0),DateTimeOffset:je(null,null,!0),Decimal:je(null,null,!0),DefiningExpression:je(null,null,!0),Dependent:je(["Role"],["PropertyRef*"]),Documentation:je(null,null,!0),End:je(["Type","Role","Multiplicity","EntitySet"],["OnDelete"]),EntityContainer:je(["Name","Extends"],["EntitySet*","AssociationSet*","FunctionImport*","TypeAnnotation*","ValueAnnotation*"]),EntitySet:je(["Name","EntityType"],["TypeAnnotation*","ValueAnnotation*"]),EntityType:je(["Name","BaseType","Abstract","OpenType"],["Key","Property*","NavigationProperty*","TypeAnnotation*","ValueAnnotation*"]),EnumType:je(["Name","UnderlyingType","IsFlags"],["Member*"]),Float:je(null,null,!0),Function:je(["Name","ReturnType"],["Parameter*","DefiningExpression","ReturnType","TypeAnnotation*","ValueAnnotation*"]),FunctionImport:je(["Name","ReturnType","EntitySet","IsSideEffecting","IsComposable","IsBindable","EntitySetPath"],["Parameter*","ReturnType","TypeAnnotation*","ValueAnnotation*"]),Guid:je(null,null,!0),Int:je(null,null,!0),Key:je(null,["PropertyRef*"]),LabeledElement:je(["Name"],["Path","String","Int","Float","Decimal","Bool","DateTime","DateTimeOffset","Guid","Binary","Time","Collection","Record","LabeledElement","Null"]),Member:je(["Name","Value"]),NavigationProperty:je(["Name","Relationship","ToRole","FromRole","ContainsTarget"],["TypeAnnotation*","ValueAnnotation*"]),Null:je(null,null),OnDelete:je(["Action"]),Path:je(null,null,!0),Parameter:je(["Name","Type","Mode","Nullable","DefaultValue","MaxLength","FixedLength","Precision","Scale","Unicode","Collation","ConcurrencyMode","SRID"],["CollectionType","ReferenceType","RowType","TypeRef","TypeAnnotation*","ValueAnnotation*"]),Principal:je(["Role"],["PropertyRef*"]),Property:je(["Name","Type","Nullable","DefaultValue","MaxLength","FixedLength","Precision","Scale","Unicode","Collation","ConcurrencyMode","CollectionKind","SRID"],["CollectionType","ReferenceType","RowType","TypeAnnotation*","ValueAnnotation*"]),PropertyRef:je(["Name"]),PropertyValue:je(["Property","Path","String","Int","Float","Decimal","Bool","DateTime","DateTimeOffset","Guid","Binary","Time"],["Path","String","Int","Float","Decimal","Bool","DateTime","DateTimeOffset","Guid","Binary","Time","Collection","Record","LabeledElement","Null"]),ReferenceType:je(["Type"]),ReferentialConstraint:je(null,["Principal","Dependent"]),ReturnType:je(["ReturnType","Type","EntitySet"],["CollectionType","ReferenceType","RowType"]),RowType:je(["Property*"]),String:je(null,null,!0),Schema:je(["Namespace","Alias"],["Using*","EntityContainer*","EntityType*","Association*","ComplexType*","Function*","ValueTerm*","Annotations*"]),Time:je(null,null,!0),TypeAnnotation:je(["Term","Qualifier"],["PropertyValue*"]),TypeRef:je(["Type","Nullable","DefaultValue","MaxLength","FixedLength","Precision","Scale","Unicode","Collation","SRID"]),Using:je(["Namespace","Alias"]),ValueAnnotation:je(["Term","Qualifier","Path","String","Int","Float","Decimal","Bool","DateTime","DateTimeOffset","Guid","Binary","Time"],["Path","String","Int","Float","Decimal","Bool","DateTime","DateTimeOffset","Guid","Binary","Time","Collection","Record","LabeledElement","Null"]),ValueTerm:je(["Name","Type"],["TypeAnnotation*","ValueAnnotation*"]),Edmx:je(["Version"],["DataServices","Reference*","AnnotationsReference*"],!1,Jc),DataServices:je(null,["Schema*"],!1,Jc)}},le=["m:FC_ContentKind","m:FC_KeepInContent","m:FC_NsPrefix","m:FC_NsUri","m:FC_SourcePath","m:FC_TargetPath"];ke.elements.Property.attributes=ke.elements.Property.attributes.concat(le),ke.elements.EntityType.attributes=ke.elements.EntityType.attributes.concat(le),ke.elements.Edmx={attributes:["Version"],elements:["DataServices"],ns:Jc},ke.elements.DataServices={elements:["Schema*"],ns:Jc},ke.elements.EntityContainer.attributes.push("m:IsDefaultEntityContainer"),ke.elements.Property.attributes.push("m:MimeType"),ke.elements.FunctionImport.attributes.push("m:HttpMethod"),ke.elements.FunctionImport.attributes.push("m:IsAlwaysBindable"),ke.elements.EntityType.attributes.push("m:HasStream"),ke.elements.DataServices.attributes=["m:DataServiceVersion","m:MaxDataServiceVersion"];var me=function(a){if(!a)return a;if(a.length>1){var b=a.substr(0,2);return b===b.toUpperCase()?a:a.charAt(0).toLowerCase()+a.substr(1)}return a.charAt(0).toLowerCase()},ne=function(a,b){if("Documentation"===b)return{isArray:!0,propertyName:"documentation"};var c=a.elements;if(!c)return null;var d,e;for(d=0,e=c.length;d<e;d++){var f=c[d],g=!1;if("*"===f.charAt(f.length-1)&&(g=!0,f=f.substr(0,f.length-1)),b===f){return{isArray:g,propertyName:me(f)}}}return null},oe=/^(m:FC_.*)_[0-9]+$/,pe=function(a){return a===Hc+"2006/04/edm"||a===Hc+"2007/05/edm"||a===Hc+"2008/01/edm"||a===Hc+"2008/09/edm"||a===Hc+"2009/08/edm"||a===Hc+"2009/11/edm"},qe=function(a){var b=fa(a),c=ga(a),d=ke.elements[b];if(!d)return null;if(d.ns){if(c!==d.ns)return null}else if(!pe(c))return null;var e={},f=[],h=d.attributes||[];return W(a,function(a){var b=fa(a),c=ga(a),d=a.value;if(c!==I){var i=null,j=!1;if(pe(c)||null===c?i="":c===Kc&&(i="m:"),null!==i){i+=b;var k=oe.exec(i);k&&(i=k[1]),g(h,i)&&(j=!0,e[me(b)]=d)}j||f.push(Lc(a))}}),$(a,function(a){var b=fa(a),c=ne(d,b);if(c)if(c.isArray){var g=e[c.propertyName];g||(g=[],e[c.propertyName]=g),g.push(qe(a))}else e[c.propertyName]=qe(a);else f.push(Mc(a))}),d.text&&(e.text=ea(a)),f.length&&(e.extensions=f),e},re=function(a,b){var c=T(b),d=ba(c);return qe(d)||void 0};d.metadataHandler=Ub(re,null,"application/xml","3.0");var se={readLink:"self",editLink:"edit",nextLink:"__next",mediaReadLink:"media_src",mediaEditLink:"edit_media",mediaContentType:"content_type",mediaETag:"media_etag",count:"__count",media_src:"mediaReadLink",edit_media:"mediaEditLink",content_type:"mediaContentType",media_etag:"mediaETag",url:"uri"},te={metadata:"odata.metadata",count:"odata.count",next:"odata.nextLink",id:"odata.id",etag:"odata.etag",read:"odata.readLink",edit:"odata.editLink",mediaRead:"odata.mediaReadLink",mediaEdit:"odata.mediaEditLink",mediaEtag:"odata.mediaETag",mediaContentType:"odata.mediaContentType",actions:"odata.actions",functions:"odata.functions",navigationUrl:"odata.navigationLinkUrl",associationUrl:"odata.associationLinkUrl",type:"odata.type"},ue=function(a){if(a.indexOf(".")>0){var b=a.indexOf("@"),c=b>-1?a.substring(0,b):null,d=a.substring(b+1);return{target:c,name:d,isOData:0===d.indexOf("odata.")}}return null},ve=function(a,b,c,d,e){return Oa(b)&&b["odata.type"]||c&&c[a+"@odata.type"]||d&&d.type||fb(d,e)||null},we=function(a,b){return b?Za(b.property,a)||Za(b.navigationProperty,a):null},xe=function(a){return Oa(a)&&"odata.id"in a},ye=function(a,b,c){if(b[a+"@odata.navigationLinkUrl"]||c&&c.relationship)return!0;var d=l(b[a])?b[a][0]:b[a];return xe(d)},ze=function(a){return Xa(a)||Ta(a)||Ua(a)},Ae=function(a,b,c,d,e){for(var f in a)if(f.indexOf(".")>0&&"#"!==f.charAt(0)){var g=ue(f);if(g){var h=g.name,i=g.target,j=null,k=null;i&&(j=we(i,d),k=ve(i,a[i],a,j,e)),g.isOData?Be(h,i,k,a[f],a,b,c):b[f]=a[f]}}return b},Be=function(a,b,c,d,e,f,g){var h=a.substring("odata.".length);switch(h){case"navigationLinkUrl":return void Fe(h,b,c,d,e,f,g);case"nextLink":case"count":return void De(h,b,d,f,g);case"mediaReadLink":case"mediaEditLink":case"mediaContentType":case"mediaETag":return void Ee(h,b,c,d,f,g);default:return void Ce(h,b,d,f,g)}},Ce=function(a,b,c,d,e){var f=d.__metadata=d.__metadata||{},g=se[a]||a;if("editLink"===a)return f.uri=z(c,e),void(f[g]=f.uri);if("readLink"!==a&&"associationLinkUrl"!==a||(c=z(c,e)),b){var h=f.properties=f.properties||{},i=h[b]=h[b]||{};return"type"===a?void(i[g]=i[g]||c):void(i[g]=c)}f[g]=c},De=function(a,b,c,d,e){var f=se[a];(b?d[b]:d)[f]="nextLink"===a?z(c,e):c},Ee=function(a,b,c,d,e,f){var g=e.__metadata=e.__metadata||{},h=se[a];if("mediaReadLink"!==a&&"mediaEditLink"!==a||(d=z(d,f)),b){var i=g.properties=g.properties||{},j=i[b]=i[b]||{};return j.type=j.type||c,e.__metadata=g,e[b]=e[b]||{__mediaresource:{}},void(e[b].__mediaresource[h]=d)}g[h]=d},Fe=function(a,b,c,d,e,f,g){var h=f.__metadata=f.__metadata||{},i=h.properties=h.properties||{},j=i[b]=i[b]||{},k=z(d,g);if(e.hasOwnProperty(b))return void(j.navigationLinkUrl=k);f[b]={__deferred:{uri:k}},j.type=j.type||c},Ge=function(a,b,c,d,e,f,g){if("string"==typeof a)return He(a,b,g);if(!ze(b)){if(l(a))return Ie(a,b,c,d,f,g);if(Oa(a))return Je(a,b,c,d,f,g)}return a},He=function(a,b,c){switch(b){case"Edm.Time":return tb(a);case"Edm.DateTime":return qb(a,!1);case"Edm.DateTimeOffset":return rb(a,!1)}return c?qb(a,!0)||rb(a,!0)||a:a},Ie=function(a,b,c,d,e,f){var g,h,i=Ia(b),j=[],k=[];for(g=0,h=a.length;g<h;g++){var l=ve(null,a[g])||i,m={type:l},n=Ge(a[g],l,m,d,0,e,f);ze(l)||Wa(a[g])||j.push(m),k.push(n)}return j.length>0&&(c.elements=j),{__metadata:{type:b},results:k}},Je=function(a,b,c,d,e,f){var g=Le(a,{type:b},d,e,f),h=g.__metadata,i=h.properties;return i&&(c.properties=i,delete h.properties),g},Ke=function(a,b,c,d,e){return l(a)?Ne(a,b,c,d,e):Oa(a)?Le(a,b,c,d,e):null},Le=function(a,b,c,d,e){b=b||{};var f=a["odata.type"]||b.type||null,g=bb(f,d),h=!0;g||(h=!1,g=ab(f,d));var i,j={type:f},k={__metadata:j},l={};if(h&&g&&b.entitySet&&"minimalmetadata"==b.contentTypeOdata){var m=c.substring(0,c.lastIndexOf("$metadata"));for(i=null,g.key||(i=g);i&&!i.key&&i.baseType;)i=bb(i.baseType,d);if(g.key||i&&i.key){var n;if(n=g.key?Oe(a,g):Oe(a,i)){var o={key:n,entitySet:b.entitySet,functionImport:b.functionImport,containerName:b.containerName};Pe(a,o,f,m,g,i)}}}for(var p in a)if(0===p.indexOf("#"))Me(p.substring(1),a[p],k,c,d);else if(-1===p.indexOf(".")){j.properties||(j.properties=l);var q=a[p],r=r=we(p,g);for(i=g;g&&null===r&&i.baseType;)i=bb(i.baseType,d),r=r=we(p,i);var s=ye(p,a,r),t=ve(p,q,a,r,d),u=l[p]=l[p]||{type:t};if(s){var v={};if(void 0!==b.entitySet){var w=gb(r,b.entitySet.name,d);v=hb(w,d)}v.contentTypeOdata=b.contentTypeOdata,v.kind=b.kind,v.type=t,k[p]=Ke(q,v,c,d,e)}else k[p]=Ge(q,t,u,c,0,d,e)}return Ae(a,k,c,g,d)},Me=function(a,b,c,d,e){if(a&&(l(b)||Oa(b))){var f=!1,g=a.lastIndexOf("."),h=a.substring(g+1),i=g>-1?a.substring(0,g):"",j=h===a||-1===i.indexOf(".")?cb(e):db(i,e);if(j){var k=eb(j.functionImport,h);k&&k.isSideEffecting&&(f=!nb(k.isSideEffecting))}var m,n,o=c.__metadata,p=f?"functions":"actions",q=z(a,d),r=l(b)?b:[b];for(m=0,n=r.length;m<n;m++){var s=r[m];if(s){var t=o[p]=o[p]||[],u={metadata:q,title:s.title,target:z(s.target,d)};t.push(u)}}}},Ne=function(a,b,c,d,e){var f,g,h,i=l(a)?a:a.value,j=[];for(f=0,g=i.length;f<g;f++)h=Le(i[f],b,c,d,e),j.push(h);var k={results:j};if(Oa(a)){for(var m in a)0===m.indexOf("#")&&(k.__metadata=k.__metadata||{},Me(m.substring(1),a[m],k,c,d));k=Ae(a,k,c)}return k},Oe=function(a,b){var c,d,e=b.key.propertyRef;if(c="(",1==e.length)d=Za(b.property,e[0].name).type,c+=Te(a[e[0].name],d);else for(var f=!0,g=0;g<e.length;g++)f?f=!1:c+=",",d=Za(b.property,e[g].name).type,c+=e[g].name+"="+Te(a[e[g].name],d);return c+=")"},Pe=function(a,b,c,d,e,f){var g=a[te.id]||a[te.read]||a[te.edit]||b.entitySet.name+b.key;if(a[te.id]=d+g,a[te.edit]||(a[te.edit]=b.entitySet.name+b.key,b.entitySet.entityType!=c&&(a[te.edit]+="/"+c)),a[te.read]=a[te.read]||a[te.edit],!a[te.etag]){var h=Qe(a,e,f);h&&(a[te.etag]=h)}We(a,e,f),Se(a,e,f),Ve(a,b)},Qe=function(a,b,c){for(var d,e="",f=0;b.property&&f<b.property.length;f++)d=b.property[f],e=Re(a,e,d);if(c)for(f=0;c.property&&f<c.property.length;f++)d=c.property[f],e=Re(a,e,d);return e.length>0?e+'"':null},Re=function(a,b,c){return"Fixed"==c.concurrencyMode&&(b.length>0?b+=",":b+='W/"',null!==a[c.name]?b+=Te(a[c.name],c.type):b+="null"),b},Se=function(a,b,c){for(var d,e,f,g=0;b.navigationProperty&&g<b.navigationProperty.length;g++)d=b.navigationProperty[g].name,e=d+"@odata.navigationLinkUrl",void 0===a[e]&&(a[e]=a[te.edit]+"/"+encodeURIComponent(d)),f=d+"@odata.associationLinkUrl",void 0===a[f]&&(a[f]=a[te.edit]+"/$links/"+encodeURIComponent(d));if(c&&c.navigationProperty)for(g=0;g<c.navigationProperty.length;g++)d=c.navigationProperty[g].name,e=d+"@odata.navigationLinkUrl",void 0===a[e]&&(a[e]=a[te.edit]+"/"+encodeURIComponent(d)),f=d+"@odata.associationLinkUrl",void 0===a[f]&&(a[f]=a[te.edit]+"/$links/"+encodeURIComponent(d))},Te=function(a,b){switch(a=""+Ue(a,b),a=encodeURIComponent(a.replace("'","''")),b){case"Edm.Binary":return"X'"+a+"'";case"Edm.DateTime":return"datetime'"+a+"'";case"Edm.DateTimeOffset":return"datetimeoffset'"+a+"'";case"Edm.Decimal":return a+"M";case"Edm.Guid":return"guid'"+a+"'";case"Edm.Int64":return a+"L";case"Edm.Float":return a+"f";case"Edm.Double":return a+"D";case"Edm.Geography":return"geography'"+a+"'";case"Edm.Geometry":return"geometry'"+a+"'";case"Edm.Time":return"time'"+a+"'";case"Edm.String":return"'"+a+"'";default:return a}},Ue=function(a,b){switch(b){case"Edm.Binary":return C(a);default:return a}},Ve=function(a,b){for(var c=b.functionImport||[],d=0;d<c.length;d++)if(c[d].isBindable&&c[d].parameter[0]&&c[d].parameter[0].type==b.entitySet.entityType){var e="#"+b.containerName+"."+c[d].name;void 0==a[e]&&(a[e]={title:c[d].name,target:a[te.edit]+"/"+c[d].name})}},We=function(a,b,c){(b.hasStream||c&&c.hasStream)&&(a[te.mediaEdit]=a[te.mediaEdit]||a[te.mediaEdit]+"/$value",a[te.mediaRead]=a[te.mediaRead]||a[te.mediaEdit])},Xe=function(a,b,c,d){var e={type:b},f=Ge(a.value,b,e,c,0,null,d);return Ae(a,{__metadata:e,value:f},c)},Ye=function(a,b,c,d,e){var f={},g=Ie(a.value,b,f,c,d,e);return j(g.__metadata,f),Ae(a,g,c)},Ze=function(a,b){var c=a.value;if(!l(c))return $e(a,b);var d,e,f=[];for(d=0,e=c.length;d<e;d++)f.push($e(c[d],b));return Ae(a,{results:f},b)},$e=function(a,b){var c={uri:z(a.url,b)};c=Ae(a,c,b);var d=c.__metadata||{},e=d.properties||{};return _e(e.url),p(e,"url","uri"),c},_e=function(a){a&&delete a.type},af=function(a,b){var c=a.value,d=[],e=Ae(a,{collections:d},b),f=e.__metadata||{},g=f.properties||{};_e(g.value),p(g,"value","collections");var h,i;for(h=0,i=c.length;h<i;h++){var j=c[h],k={title:j.name,href:z(j.url,b)};k=Ae(j,k,b),f=k.__metadata||{},g=f.properties||{},_e(g.name),_e(g.url),p(g,"name","title"),p(g,"url","href"),d.push(k)}return{workspaces:[e]}},bf=function(a,b){return{kind:a,type:b||null}},cf=function(a,b,c){var d=a["odata.metadata"];if(!d||"string"!=typeof d)return null;var e=d.lastIndexOf("#");if(-1===e)return bf("s");var f=d.indexOf("@Element",e),g=f-1;g<0&&-1===(g=d.indexOf("?",e))&&(g=d.length);var h=d.substring(e+1,g);if(h.indexOf("/$links/")>0)return bf("l");var i=h.split("/");if(i.length>=0){var j=i[0],k=i[1];if(ze(j))return bf("p",j);if(Na(j))return bf("c",j);var m,n,o,p=k;if(!k){var q=j.lastIndexOf("."),r=j.substring(q+1),s=r===j?cb(b):db(j.substring(0,q),b);s&&(m=_a(s.entitySet,r),n=s.functionImport,o=s.name,p=m?m.entityType:null)}var t;if(f>0)return t=bf("o",p),t.entitySet=m,t.functionImport=n,t.containerName=o,t;if(p)return t=bf("f",p),t.entitySet=m,t.functionImport=n,t.containerName=o,t;if(l(a.value)&&!ab(j,b)){var u=a.value[0];if(!Wa(u)&&(xe(u)||!c))return bf("f",null)}return bf("o",j)}return null},df=function(a,b,c,d,e){if(!Oa(a))return a;e=e||"minimalmetadata";var g=a["odata.metadata"],h=cf(a,b,d);f(h)&&(h.contentTypeOdata=e);var i=null;if(h)switch(delete a["odata.metadata"],i=h.type,h.kind){case"f":return Ne(a,h,g,b,c);case"c":return Ye(a,i,g,b,c);case"p":return Xe(a,i,g,c);case"s":return af(a,g);case"l":return Ze(a,g)}return Le(a,h,g,b,c)},ef=["type","etag","media_src","edit_media","content_type","media_etag"],ff=function(a,b){var c=/\/\$links\//,d={},e=a.__metadata,f=b&&c.test(b.request.requestUri);return hf(a,e&&e.properties,d,f),d},gf=function(a,b){if(a){var c,d;for(c=0,d=ef.length;c<d;c++){var e=ef[c],f="odata."+(se[e]||e);qf(f,null,a[e],b)}}},hf=function(a,b,c,d){for(var e in a){var f=a[e];"__metadata"===e?gf(f,c):-1===e.indexOf(".")?d&&"uri"===e?kf(f,c):jf(e,f,b,c,d):c[e]=f}},jf=function(a,b,c,d){var e=c&&c[a]||{properties:void 0,type:void 0},f=ya(b,e);return Wa(b)||!b?(qf("odata.type",a,f,d),void(d[a]=b)):Sa(b,f)||Ra(b)?void nf(a,b,d):!f&&Qa(b)?void lf(a,b,d):Ma(b,f)?(Ia(f)&&qf("odata.type",a,f,d),void mf(a,b,d)):(d[a]={},qf("odata.type",null,f,d[a]),void hf(b,e.properties,d[a]))},kf=function(a,b){b.url=a},lf=function(a,b,c){qf("odata.navigationLinkUrl",a,b.__deferred.uri,c)},mf=function(a,b,c){c[a]=[];var d=l(b)?b:b.results;hf(d,null,c[a])},nf=function(a,b,c){if(Sa(b)){c[a]=[];var d,e,f=l(b)?b:b.results;for(d=0,e=f.length;d<e;d++)of(a,f[d],!0,c)}else of(a,b,!1,c)},of=function(a,b,c,d){var e=b.__metadata&&b.__metadata.uri;if(e)return void pf(a,e,c,d);var f=ff(b);if(c)return void d[a].push(f);d[a]=f},pf=function(a,b,c,d){var e=a+"@odata.bind";if(c)return d[e]=d[e]||[],void d[e].push(b);d[e]=b},qf=function(a,b,c,d){void 0!==c&&(b?d[b+"@"+a]=c:d[a]=c)},rf=Ib("application/json"),sf=function(a){var b=[];for(var c in a){var d,e;for(d=0,e=a[c].length;d<e;d++)b.push(j({metadata:c},a[c][d]))}return b},tf=function(a,b,c,d){if(a&&"object"==typeof a){var e,f=a.__metadata;f&&(f.actions&&(f.actions=sf(f.actions)),f.functions&&(f.functions=sf(f.functions)),e=f&&f.type);var g,h=bb(e,b)||ab(e,b);if(h){var i=h.property;if(i){var j,k;for(j=0,k=i.length;j<k;j++){var l=i[j],m=l.name;if(g=a[m],"Edm.DateTime"===l.type||"Edm.DateTimeOffset"===l.type){if(g){if(!(g=c(g)))throw{message:"Invalid date/time value"};a[m]=g}}else"Edm.Time"===l.type&&(a[m]=tb(g))}}}else if(d)for(var n in a)"string"==typeof(g=a[n])&&(a[n]=c(g)||g)}return a},uf=function(a){if(a){var b=a.properties.odata;return"nometadata"===b||"minimalmetadata"===b||"fullmetadata"===b}return!1},vf=function(a,b){var c,d,e={collections:[]};for(c=0,d=a.EntitySets.length;c<d;c++){var f=a.EntitySets[c],g={title:f,href:z(f,b)};e.collections.push(g)}return{workspaces:[e]}},wf=/^\/Date\((-?\d+)(\+|-)?(\d+)?\)\/$/,xf=function(a){var b;a<0?(b="-",a=-a):b="+";var c=Math.floor(a/60);return a-=60*c,b+Ga(c,2)+":"+Ga(a,2)},yf=function(a){var b=a&&wf.exec(a);if(b){var c=new Date(o(b[1]));if(b[2]){var d=o(b[3]);"-"===b[2]&&(d=-d);var e=c.getUTCMinutes();c.setUTCMinutes(e-d),c.__edmType="Edm.DateTimeOffset",c.__offset=xf(d)}if(!isNaN(c.valueOf()))return c}},zf=function(b,c,d){var e=h(d.recognizeDates,b.recognizeDates),f=h(d.inferJsonLightFeedAsObject,b.inferJsonLightFeedAsObject),g=d.metadata,i=d.dataServiceVersion,j=yf,k="string"==typeof c?a.JSON.parse(c):c;if(kb("3.0",i)===i){if(uf(d.contentType))return df(k,g,e,f,d.contentType.properties.odata);j=qb}return k=xb(k.d,function(a,b){return tf(b,g,j,e)}),k=Ef(k,d.dataServiceVersion),Df(k,d.response.requestUri)},Af=function(b){var c,d=Date.prototype.toJSON;try{Date.prototype.toJSON=function(){return Ea(this)},c=a.JSON.stringify(b,Cf)}finally{Date.prototype.toJSON=d}return c},Bf=function(a,b,c){var d=c.dataServiceVersion||"1.0",e=h(c.useJsonLight,a.useJsonLight),f=c.contentType=c.contentType||rf;if(f&&f.mediaType===rf.mediaType){var g=b;return e||uf(f)?(c.dataServiceVersion=kb(d,"3.0"),g=ff(b,c),Af(g)):(kb("3.0",d)===d&&(f.properties.odata="verbose",c.contentType=f),Af(g))}},Cf=function(a,b){return b&&"Edm.Time"===b.__edmType?Fa(b):b},Df=function(a,b){return Oa(a)&&!a.__metadata&&l(a.EntitySets)?vf(a,b):a},Ef=function(a,b){return b&&b.lastIndexOf(";")===b.length-1&&(b=b.substr(0,b.length-1)),b&&"1.0"!==b||l(a)&&(a={results:a}),a},Ff=Ub(zf,Bf,"application/json","3.0");Ff.recognizeDates=!1,Ff.useJsonLight=!1,Ff.inferJsonLightFeedAsObject=!1,d.jsonHandler=Ff;var Gf=/^HTTP\/1\.\d (\d{3}) (.*)$/i,Hf=/^([^()<>@,;:\\"\/[\]?={} \t]+)\s?:\s?(.*)/,If=function(){return Math.floor(65536*(1+Math.random())).toString(16).substr(1)},Jf=function(a){return a+If()+"-"+If()+"-"+If()},Kf=function(a){return a.handler.partHandler},Lf=function(a){var b=a.boundaries;return b[b.length-1]},Mf=function(a,b,c){var d=c.contentType.properties.boundary;return{__batchResponses:Of(b,{boundaries:[d],handlerContext:c})}},Nf=function(a,b,c){if("multipart/mixed"===(c.contentType=c.contentType||Ib("multipart/mixed")).mediaType)return Tf(b,c)},Of=function(a,b){var c="--"+Lf(b);Sf(a,b,c),Rf(a,b);for(var d,e=[];"--"!==d&&b.position<a.length;){var f,g=Pf(a,b),h=Ib(g["Content-Type"]);if(h&&"multipart/mixed"===h.mediaType){b.boundaries.push(h.properties.boundary);try{f=Of(a,b)}catch(j){j.response=Qf(a,b,c),f=[j]}e.push({__changeResponses:f}),b.boundaries.pop(),Sf(a,b,"--"+Lf(b))}else{if(!h||"application/http"!==h.mediaType)throw{message:"invalid MIME part type "};Rf(a,b);var i=Qf(a,b,c);try{i.statusCode>=200&&i.statusCode<=299?Kf(b.handlerContext).read(i,b.handlerContext):i={message:"HTTP request failed",response:i}}catch(j){i=j}e.push(i)}d=a.substr(b.position,2),Rf(a,b)}return e},Pf=function(a,b){var c,d,e,f={};do{e=b.position,d=Rf(a,b),c=Hf.exec(d),null!==c?f[c[1]]=c[2]:b.position=e}while(d&&c);return mb(f),f},Qf=function(a,b,c){var d,e,f,g=b.position,h=Gf.exec(Rf(a,b));return h?(d=h[1],e=h[2],f=Pf(a,b),Rf(a,b)):b.position=g,{statusCode:d,statusText:e,headers:f,body:Sf(a,b,c)}},Rf=function(a,b){return Sf(a,b,"\r\n")},Sf=function(a,b,c){var d=b.position||0,e=a.length;if(c){if(-1===(e=a.indexOf(c,d)))return null;b.position=e+c.length}else b.position=e;return a.substring(d,e)},Tf=function(a,b){if(!Ka(a))throw{message:"Data is not a batch object."};var c,d,e=Jf("batch_"),f=a.__batchRequests,g="";for(c=0,d=f.length;c<d;c++)g+=Uf(e,!1)+Vf(f[c],b);return g+=Uf(e,!0),b.contentType.properties.boundary=e,g},Uf=function(a,b){var c="\r\n--"+a;return b&&(c+="--"),c+"\r\n"},Vf=function(a,b,c){var d,e=a.__changeRequests;if(l(e)){if(c)throw{message:"Not Supported: change set nested in other change set"};var f=Jf("changeset_");d="Content-Type: multipart/mixed; boundary="+f+"\r\n";var g,h;for(g=0,h=e.length;g<h;g++)d+=Uf(f,!1)+Vf(e[g],b,!0);d+=Uf(f,!0)}else{d="Content-Type: application/http\r\nContent-Transfer-Encoding: binary\r\n\r\n";var i=j({},b);i.handler=Ub,i.request=a,i.contentType=null,vb(a,Kf(b),i),d+=Wf(a)}return d},Wf=function(a){var b=(a.method?a.method:"GET")+" "+a.requestUri+" HTTP/1.1\r\n";for(var c in a.headers)a.headers[c]&&(b=b+c+": "+a.headers[c]+"\r\n");return b+="\r\n",a.body&&(b+=a.body),b};d.batchHandler=Ub(Mf,Nf,"multipart/mixed","3.0");var Xf=[d.jsonHandler,d.atomHandler,d.xmlHandler,d.textHandler],Yf=function(a,b,c){var d,e;for(d=0,e=Xf.length;d<e&&!Xf[d][a](b,c);d++);if(d===e)throw{message:"no handler for data"}};d.defaultSuccess=function(b){a.alert(a.JSON.stringify(b))},d.defaultError=q,d.defaultHandler={read:function(a,b){a&&f(a.body)&&a.headers["Content-Type"]&&Yf("read",a,b)},write:function(a,b){Yf("write",a,b)},maxDataServiceVersion:"3.0",accept:"application/atomsvc+xml;q=0.8, application/json;odata=fullmetadata;q=0.7, application/json;q=0.5, */*;q=0.1"},d.defaultMetadata=[],
d.read=function(a,b,c,e,f,g){var h;return h=a instanceof String||"string"==typeof a?{requestUri:a}:a,d.request(h,b,c,e,f,g)},d.request=function(a,b,c,e,f,g){b=b||d.defaultSuccess,c=c||d.defaultError,e=e||d.defaultHandler,f=f||d.defaultHttpClient,g=g||d.defaultMetadata,a.recognizeDates=h(a.recognizeDates,d.jsonHandler.recognizeDates),a.callbackParameterName=h(a.callbackParameterName,d.defaultHttpClient.callbackParameterName),a.formatQueryString=h(a.formatQueryString,d.defaultHttpClient.formatQueryString),a.enableJsonpCallback=h(a.enableJsonpCallback,d.defaultHttpClient.enableJsonpCallback),a.useJsonLight=h(a.useJsonLight,d.jsonHandler.enableJsonpCallback),a.inferJsonLightFeedAsObject=h(a.inferJsonLightFeedAsObject,d.jsonHandler.inferJsonLightFeedAsObject);var i={metadata:g,recognizeDates:a.recognizeDates,callbackParameterName:a.callbackParameterName,formatQueryString:a.formatQueryString,enableJsonpCallback:a.enableJsonpCallback,useJsonLight:a.useJsonLight,inferJsonLightFeedAsObject:a.inferJsonLightFeedAsObject};try{return vb(a,e,i),Ja(a,b,c,e,f,i)}catch(j){c(j)}},d.parseMetadata=function(a){return re(0,a)},d.batchHandler.partHandler=d.defaultHandler;var Zf=null,$f=function(){var a={v:this.valueOf(),t:"[object Date]"};for(var b in this)a[b]=this[b];return a},_f=function(a,b){if(b&&"[object Date]"===b.t){var c=new Date(b.v);for(var d in b)"t"!==d&&"v"!==d&&(c[d]=b[d]);b=c}return b},ag=function(a,b){return a.name+"#!#"+b},bg=function(a,b){return b.replace(a.name+"#!#","")},cg=function(a){this.name=a};cg.create=function(b){if(cg.isSupported())return Zf=Zf||a.localStorage,new cg(b);throw{message:"Web Storage not supported by the browser"}},cg.isSupported=function(){return!!a.localStorage},cg.prototype.add=function(a,b,c,d){d=d||this.defaultError;var e=this;this.contains(a,function(f){f?i(d,{message:"key already exists",key:a}):e.addOrUpdate(a,b,c,d)},d)},cg.prototype.addOrUpdate=function(b,c,d,e){if(e=e||this.defaultError,b instanceof Array)e({message:"Array of keys not supported"});else{var f=ag(this,b),g=Date.prototype.toJSON;try{var h=c;void 0!==h&&(Date.prototype.toJSON=$f,h=a.JSON.stringify(c)),Zf.setItem(f,h),i(d,b,c)}catch(j){22===j.code||2147942414===j.number?i(e,{name:"QUOTA_EXCEEDED_ERR",error:j}):i(e,j)}finally{Date.prototype.toJSON=g}}},cg.prototype.clear=function(a,b){b=b||this.defaultError;try{for(var c=0,d=Zf.length;d>0&&c<d;){var e=Zf.key(c);e!==bg(this,e)?(Zf.removeItem(e),d=Zf.length):c++}i(a)}catch(f){i(b,f)}},cg.prototype.close=function(){},cg.prototype.contains=function(a,b,c){c=c||this.defaultError;try{var d=ag(this,a),e=Zf.getItem(d);i(b,null!==e)}catch(f){i(c,f)}},cg.prototype.defaultError=q,cg.prototype.getAllKeys=function(a,b){b=b||this.defaultError;var c,d,e=[];try{for(c=0,d=Zf.length;c<d;c++){var f=Zf.key(c),g=bg(this,f);f!==g&&e.push(g)}i(a,e)}catch(h){i(b,h)}},cg.prototype.mechanism="dom",cg.prototype.read=function(b,c,d){if(d=d||this.defaultError,b instanceof Array)d({message:"Array of keys not supported"});else try{var e=ag(this,b),f=Zf.getItem(e);f=null!==f&&"undefined"!==f?a.JSON.parse(f,_f):void 0,i(c,b,f)}catch(g){i(d,g)}},cg.prototype.remove=function(a,b,c){if(c=c||this.defaultError,a instanceof Array)c({message:"Batches not supported"});else try{var d=ag(this,a);Zf.removeItem(d),i(b)}catch(e){i(c,e)}},cg.prototype.update=function(a,b,c,d){d=d||this.defaultError;var e=this;this.contains(a,function(f){f?e.addOrUpdate(a,b,c,d):i(d,{message:"key not found",key:a})},d)};var dg=a.mozIndexedDB||a.webkitIndexedDB||a.msIndexedDB||a.indexedDB,eg=a.IDBKeyRange||a.webkitIDBKeyRange,fg=a.IDBTransaction||a.webkitIDBTransaction||{},gg=fg.READ_ONLY||"readonly",hg=fg.READ_WRITE||"readwrite",ig=function(a,b){return function(c){var d=a||b;if(d){if("[object IDBDatabaseException]"===Object.prototype.toString.call(c))return 11===c.code?void d({name:"QuotaExceededError",error:c}):void d(c);var e;try{var f=c.target.error||c;e=f.name}catch(g){e="blocked"===c.type?"IndexedDBBlocked":"UnknownError"}d({name:e,error:c})}}},jg=function(a,b,c){var d=a.name,e="_datajs_"+d,f=dg.open(e);f.onblocked=c,f.onerror=c,f.onupgradeneeded=function(){var a=f.result;a.objectStoreNames.contains(d)||a.createObjectStore(d)},f.onsuccess=function(a){var e=f.result;if(!e.objectStoreNames.contains(d)){if("setVersion"in e){var g=e.setVersion("1.0");return g.onsuccess=function(){g.transaction.oncomplete=function(){b(e)},e.createObjectStore(d,null,!1)},g.onerror=c,void(g.onblocked=c)}return a.target.error={name:"DBSchemaMismatch"},void c(a)}e.onversionchange=function(a){a.target.close()},b(e)}},kg=function(a,b,c,d){var e=a.name,f=a.db,g=ig(d,a.defaultError);if(f)return void c(f.transaction(e,b));jg(a,function(d){a.db=d,c(d.transaction(e,b))},g)},lg=function(a){this.name=a};lg.create=function(a){if(lg.isSupported())return new lg(a);throw{message:"IndexedDB is not supported on this browser"}},lg.isSupported=function(){return!!dg},lg.prototype.add=function(a,b,c,d){var e=this.name,f=this.defaultError,g=[],h=[];a instanceof Array?(g=a,h=b):(g=[a],h=[b]),kg(this,hg,function(i){i.onabort=ig(d,f),i.oncomplete=function(){a instanceof Array?c(g,h):c(a,b)};for(var j=0;j<g.length&&j<h.length;j++)i.objectStore(e).add({v:h[j]},g[j])},d)},lg.prototype.addOrUpdate=function(a,b,c,d){var e=this.name,f=this.defaultError,g=[],h=[];a instanceof Array?(g=a,h=b):(g=[a],h=[b]),kg(this,hg,function(i){i.onabort=ig(d,f),i.oncomplete=function(){a instanceof Array?c(g,h):c(a,b)};for(var j=0;j<g.length&&j<h.length;j++){var k={v:h[j]};i.objectStore(e).put(k,g[j])}},d)},lg.prototype.clear=function(a,b){var c=this.name,d=this.defaultError;kg(this,hg,function(e){e.onerror=ig(b,d),e.oncomplete=function(){a()},e.objectStore(c).clear()},b)},lg.prototype.close=function(){this.db&&(this.db.close(),this.db=null)},lg.prototype.contains=function(a,b,c){var d=this.name,e=this.defaultError;kg(this,gg,function(f){var g=f.objectStore(d),h=g.get(a);f.oncomplete=function(){b(!!h.result)},f.onerror=ig(c,e)},c)},lg.prototype.defaultError=q,lg.prototype.getAllKeys=function(a,b){var c=this.name,d=this.defaultError;kg(this,hg,function(e){var f=[];e.oncomplete=function(){a(f)};var g=e.objectStore(c).openCursor();g.onerror=ig(b,d),g.onsuccess=function(a){var b=a.target.result;b&&(f.push(b.key),b["continue"].call(b))}},b)},lg.prototype.mechanism="indexeddb",lg.prototype.read=function(a,b,c){var d=this.name,e=this.defaultError,f=a instanceof Array?a:[a];kg(this,gg,function(g){var h=[];g.onerror=ig(c,e),g.oncomplete=function(){a instanceof Array?b(f,h):b(f[0],h[0])};for(var i=0;i<f.length;i++){var j=g.objectStore(d);j.get.call(j,f[i]).onsuccess=function(a){var b=a.target.result;h.push(b?b.v:void 0)}}},c)},lg.prototype.remove=function(a,b,c){var d=this.name,e=this.defaultError,f=a instanceof Array?a:[a];kg(this,hg,function(a){a.onerror=ig(c,e),a.oncomplete=function(){b()};for(var g=0;g<f.length;g++){var h=a.objectStore(d);h["delete"].call(h,f[g])}},c)},lg.prototype.update=function(a,b,c,d){var e=this.name,f=this.defaultError,g=[],h=[];a instanceof Array?(g=a,h=b):(g=[a],h=[b]),kg(this,hg,function(i){i.onabort=ig(d,f),i.oncomplete=function(){a instanceof Array?c(g,h):c(a,b)};for(var j=0;j<g.length&&j<h.length;j++){var k=i.objectStore(e).openCursor(eg.only(g[j])),l={v:h[j]};k.pair={key:g[j],value:l},k.onsuccess=function(a){var b=a.target.result;b?b.update(a.target.pair.value):i.abort()}}},d)};var mg=function(a){var b=[],c=[],d={};this.name=a;var e=function(a){return a||this.defaultError},f=function(a,b){var c;return a instanceof Array&&(c="Array of keys not supported"),void 0!==a&&null!==a||(c="Invalid key"),!c||(i(b,{message:c}),!1)};this.add=function(a,b,c,g){g=e(g),f(a,g)&&(d.hasOwnProperty(a)?g({message:"key already exists",key:a}):this.addOrUpdate(a,b,c,g))},this.addOrUpdate=function(a,g,h,j){if(j=e(j),f(a,j)){var k=d[a];void 0===k&&(k=b.length>0?b.splice(0,1):c.length),c[k]=g,d[a]=k,i(h,a,g)}},this.clear=function(a){c=[],d={},b=[],i(a)},this.contains=function(a,b){var c=d.hasOwnProperty(a);i(b,c)},this.getAllKeys=function(a){var b=[];for(var c in d)b.push(c);i(a,b)},this.read=function(a,b,g){if(g=e(g),f(a,g)){var h=d[a];i(b,a,c[h])}},this.remove=function(a,g,h){if(h=e(h),f(a,h)){var j=d[a];void 0!==j&&(j===c.length-1?c.pop():(c[j]=void 0,b.push(j)),delete d[a],0===c.length&&(b=[])),i(g)}},this.update=function(a,b,c,g){g=e(g),f(a,g)&&(d.hasOwnProperty(a)?this.addOrUpdate(a,b,c,g):g({message:"key not found",key:a}))}};mg.create=function(a){return new mg(a)},mg.isSupported=function(){return!0},mg.prototype.close=function(){},mg.prototype.defaultError=q,mg.prototype.mechanism="memory";var ng={indexeddb:lg,dom:cg,memory:mg};c.defaultStoreMechanism="best",c.createStore=function(a,b){b||(b=c.defaultStoreMechanism),"best"===b&&(b=cg.isSupported()?"dom":"memory");var d=ng[b];if(d)return d.create(a);throw{message:"Failed to create store",name:a,mechanism:b}};var og=function(a,b){return a+(a.indexOf("?")>=0?"&":"?")+b},pg=function(a,b){var c=a.indexOf("?"),d="";return c>=0&&(d=a.substr(c),a=a.substr(0,c)),"/"!==a[a.length-1]&&(a+="/"),a+b+d},qg=function(a,b){return{method:"GET",requestUri:a,user:b.user,password:b.password,enableJsonpCallback:b.enableJsonpCallback,callbackParameterName:b.callbackParameterName,formatQueryString:b.formatQueryString}},rg=function(a,b,c,d){return sg(a,b,[],c,d)},sg=function(a,b,c,e,f){var g=qg(a,b),h=d.request(g,function(a){var d=a.__next,g=a.results;c=c.concat(g),d?h=sg(d,b,c,e,f):e(c)},f,void 0,b.httpClient,b.metadata);return{abort:function(){h.abort()}}},tg=function(a){var b=this,c=a.source;return b.identifier=y(encodeURI(decodeURI(c))),b.options=a,b.count=function(a,e){var f=b.options;return d.request(qg(pg(c,"$count"),f),function(b){var c=o(b.toString());isNaN(c)?e({message:"Count is NaN",count:c}):a(c)},e,void 0,f.httpClient,f.metadata)},b.read=function(a,d,e,f){return rg(og(c,"$skip="+a+"&$top="+d),b.options,e,f)},b},ug=function(a,b){var c=vg(a,b);if(c){var d=c.i-b.i,e=d+(a.c-a.d.length);a.d=a.d.concat(b.d.slice(d,e))}},vg=function(a,b){var c,d=a.i+a.c,e=b.i+b.c,f=a.i>b.i?a.i:b.i,g=d<e?d:e;return g>=f&&(c={i:f,c:g-f}),c},wg=function(a,b){if(void 0===a||"number"!=typeof a)throw{message:"'"+b+"' must be a number."};if(isNaN(a)||a<0||!isFinite(a))throw{message:"'"+b+"' must be greater than or equal to zero."}},xg=function(a,b){if(void 0!==a){if("number"!=typeof a)throw{message:"'"+b+"' must be a number."};if(isNaN(a)||a<=0||!isFinite(a))throw{message:"'"+b+"' must be greater than zero."}}},yg=function(a,b){if(void 0!==a&&("number"!=typeof a||isNaN(a)||!isFinite(a)))throw{message:"'"+b+"' must be a number."}},zg=function(a,b){var c,d;for(c=0,d=a.length;c<d;c++)if(a[c]===b)return a.splice(c,1),!0;return!1},Ag=function(a){var b=0,c=typeof a;if("object"===c&&a)for(var d in a)b+=2*d.length+Ag(a[d]);else b="string"===c?2*a.length:8;return b},Bg=function(a,b,c){return a=Math.floor(a/c)*c,b=Math.ceil((b+1)/c)*c,{i:a,c:b-a}},Cg=function(a,b,c,d,e,f,g){var h,i,j=this;j.p=b,j.i=d,j.c=e,j.d=f,j.s="start",j.canceled=!1,j.pending=g,j.oncomplete=null,j.cancel=function(){if(c){var a=j.s;"error"!==a&&"end"!==a&&"cancel"!==a&&(j.canceled=!0,l("cancel",h))}},j.complete=function(){l("end",h)},j.error=function(a){j.canceled||l("error",a)},j.run=function(a){i=a,j.transition(j.s,h)},j.wait=function(a){l("wait",a)};var k=function(b,c,d){switch(b){case"start":"init"!==c&&a(j,b,c,d);break;case"wait":a(j,b,c,d);break;case"cancel":a(j,b,c,d),j.fireCanceled(),l("end");break;case"error":a(j,b,c,d),j.canceled=!0,j.fireRejected(d),l("end");break;case"end":j.oncomplete&&j.oncomplete(j),j.canceled||j.fireResolved(),a(j,b,c,d);break;default:a(j,b,c,d)}},l=function(a,b){j.s=a,h=b,k(a,i,b)};return j.transition=l,j};Cg.prototype.fireResolved=function(){var a=this.p;a&&(this.p=null,a.resolve(this.d))},Cg.prototype.fireRejected=function(a){var b=this.p;b&&(this.p=null,b.reject(a))},Cg.prototype.fireCanceled=function(){this.fireRejected({canceled:!0,message:"Operation canceled"})};var Dg=function(b){var d,e="init",g={counts:0,netReads:0,prefetches:0,cacheReads:0},h=[],k=[],l=[],m=0,n=!1,p=s(b.cacheSize,1048576),q=0,r=0,t=0,u=0===p,v=s(b.pageSize,50),w=s(b.prefetchSize,v),x="1.0",y=0,z=b.source;"string"==typeof z&&(z=new tg(b)),z.options=b;var A=c.createStore(b.name,b.mechanism),B=this;B.onidle=b.idle,B.stats=g,B.count=function(){if(d)throw d;var a=xa(),b=!1;if(n)return i(function(){a.resolve(q)}),a.promise();var c=z.count(function(b){c=null,g.counts++,a.resolve(b)},function(d){c=null,a.reject(j(d,{canceled:b}))});return j(a.promise(),{cancel:function(){c&&(b=!0,c.abort(),c=null)}})},B.clear=function(){if(d)throw d;if(0===h.length){var a=xa(),b=new Cg(R,a,!1);return K(b,h),a.promise()}return h[0].p},B.filterForward=function(a,b,c){return H(a,b,c,!1)},B.filterBack=function(a,b,c){return H(a,b,c,!0)},B.readRange=function(a,b){if(wg(a,"index"),wg(b,"count"),d)throw d;var c=xa(),e=new Cg(T,c,!0,a,b,[],0);return K(e,k),j(c.promise(),{cancel:function(){e.cancel()}})},B.ToObservable=B.toObservable=function(){if(!a.Rx||!a.Rx.Observable)throw{message:"Rx library not available - include rx.js"};if(d)throw d;return a.Rx.Observable.CreateWithDisposable(function(a){var b=!1,c=0,d=function(c){b||a.OnError(c)},e=function(f){if(!b){var g,h;for(g=0,h=f.length;g<h;g++)a.OnNext(f[g]);f.length<v?a.OnCompleted():(c+=v,B.readRange(c,v).then(e,d))}};return B.readRange(c,v).then(e,d),{Dispose:function(){b=!0}}})};var C=function(a){return function(b){d={message:a,error:b};var c,e;for(c=0,e=k.length;c<e;c++)k[c].fireRejected(d);for(c=0,e=h.length;c<e;c++)h[c].fireRejected(d);k=h=null}},D=function(a){if(a!==e){e=a;var b,c,d=h.concat(k,l);for(b=0,c=d.length;b<c;b++)d[b].run(e)}},E=function(){var a=new wa;return A.clear(function(){m=0,n=!1,q=0,r=0,t=0,u=0===p,g={counts:0,netReads:0,prefetches:0,cacheReads:0},B.stats=g,A.close(),a.resolve()},function(b){a.reject(b)}),a},F=function(a){var b=zg(h,a);b||(b=zg(k,a))||zg(l,a),y--,D("idle")},G=function(a){var b=new wa,c=!1,d=z.read(a,v,function(c){var d={i:a,c:c.length,d:c};b.resolve(d)},function(a){b.reject(a)});return j(b,{cancel:function(){d&&(d.abort(),c=!0,d=null)}})},H=function(a,b,c,e){if(a=o(a),b=o(b),isNaN(a))throw{message:"'index' must be a valid number.",index:a};if(isNaN(b))throw{message:"'count' must be a valid number.",count:b};if(d)throw d;a=Math.max(a,0);var f=xa(),g=[],h=!1,i=null,k=function(a,d){h||(b>=0&&g.length>=b?f.resolve(g):i=B.readRange(a,d).then(function(h){for(var i=0,j=h.length;i<j&&(b<0||g.length<b);i++){var l=e?j-i-1:i,m=h[l];if(c(m)){var n={index:a+l,item:m};e?g.unshift(n):g.push(n)}}if(!e&&h.length<d||e&&a<=0)f.resolve(g);else{var o=e?Math.max(a-v,0):a+d;k(o,v)}},function(a){f.reject(a)}))},l=Bg(a,a,v),m=e?l.i:a,n=e?a-l.i+1:l.i+l.c-a;return k(m,n),j(f.promise(),{cancel:function(){i&&i.cancel(),h=!0}})},I=function(){B.onidle&&0===y&&B.onidle()},J=function(a){if(!n&&0!==w&&!u&&(0===l.length||l[0]&&-1!==l[0].c)){var b=new Cg(S,null,!0,a,w,null,w);K(b,l)}},K=function(a,b){a.oncomplete=F,b.push(a),y++,a.run(e)},L=function(a){var b=!1,c=j(new wa,{cancel:function(){b=!0}}),d=O(c,"Read page from store failure");return A.contains(a,function(e){if(!b)return e?void A.read(a,function(a,d){b||c.resolve(void 0!==d,d)},d):void c.resolve(!1)},d),c},M=function(a,b){var c=!1,d=j(new wa,{cancel:function(){c=!0}}),e=O(d,"Save page to store failure"),f=function(){d.resolve(!0)};if(b.c>0){var g=Ag(b);u=p>=0&&p<m+g,u?f():A.addOrUpdate(a,b,function(){P(b,g),N(f,e)},e)}else P(b,0),N(f,e);return d},N=function(a,b){var c={actualCacheSize:m,allDataLocal:n,cacheSize:p,collectionCount:q,highestSavedPage:r,highestSavedPageSize:t,pageSize:v,sourceId:z.identifier,version:x};A.addOrUpdate("__settings",c,a,b)},O=function(a){return function(){a.resolve(!1)}},P=function(a,b){var c=a.c,d=a.i;0===c?r===d-v&&(q=r+t):(r=Math.max(r,d),r===d&&(t=c),m+=b,c<v&&!q&&(q=d+c)),n||q!==r+t||(n=!0)},Q=function(a,b,c,d){var e=a.canceled&&"end"!==b;return e&&"cancel"===b&&d&&d.cancel&&d.cancel(),e},R=function(a,b,c){var d=a.transition;if("destroy"!==c)return D("destroy"),!0;switch(b){case"start":d("clear");break;case"end":I();break;case"clear":E().then(function(){a.complete()}),a.wait();break;default:return!1}return!0},S=function(a,b,c,d){if(!Q(a,b,0,d)){var e=a.transition;if("prefetch"!==c)return"destroy"===c?"cancel"!==b&&a.cancel():"idle"===c&&D("prefetch"),!0;switch(b){case"start":l[0]===a&&e("local",a.i);break;case"done":var f=a.pending;f>0&&(f-=Math.min(f,d.c)),n||0===f||d.c<v||u?a.complete():(a.pending=f,e("local",d.i+v));break;default:return U(a,b,c,d,!0)}}return!0},T=function(a,b,c,d){if(!Q(a,b,0,d)){var e=a.transition;if("read"!==c&&"start"!==b)return"destroy"===c?"start"!==b&&a.cancel():"write"!==c&&D("read"),!0;switch(b){case"start":if("idle"===c||"prefetch"===c)if(D("read"),a.c>0){var f=Bg(a.i,a.c,v);e("local",f.i)}else e("done",a);break;case"done":ug(a,d);var h=a.d.length;a.c===h||d.c<v?(g.cacheReads++,J(d.i+d.c),a.complete()):e("local",d.i+v);break;default:return U(a,b,c,d,!1)}}return!0},U=function(a,b,c,d,e){var f,h=a.error,i=a.transition,j=a.wait;switch(b){case"end":I();break;case"local":f=L(d).then(function(b,c){a.canceled||(b?i("done",c):i("source",d))});break;case"source":f=G(d).then(function(b){a.canceled||(e?g.prefetches++:g.netReads++,i("save",b))},h);break;case"save":"write"!==c&&(D("write"),f=M(d.i,d).then(function(b){a.canceled||(!b&&e&&(a.pending=0),i("done",d)),D("idle")}));break;default:return!1}return f&&(a.canceled?f.cancel():a.s===b&&j(f)),!0};return A.read("__settings",function(a,b){if(f(b)){var c=b.version;if(!c||0!==c.indexOf("1."))return void C("Unsupported cache store version "+c)();v!==b.pageSize||z.identifier!==b.sourceId?E().then(function(){D("idle")},C("Unable to clear store during initialization")):(m=b.actualCacheSize,n=b.allDataLocal,p=b.cacheSize,q=b.collectionCount,r=b.highestSavedPage,t=b.highestSavedPageSize,x=c,D("idle"))}else N(function(){D("idle")},C("Unable to write settings during initialization."))},C("Unable to read settings from store.")),B};c.createDataCache=function(a){if(xg(a.pageSize,"pageSize"),yg(a.cacheSize,"cacheSize"),yg(a.prefetchSize,"prefetchSize"),!f(a.name))throw{message:"Undefined or null name",options:a};if(!f(a.source))throw{message:"Undefined source",options:a};return new Dg(a)}}(this);