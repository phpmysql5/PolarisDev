!function(a){var b=a.$,c=b.map,d=b.each,e=a.dataSource,f=a.constants,g=f.DISPLAY_TYPES,h=f.MIME_TYPES,i=f.HTTP_VERBS,j=a.utils,k=j.getObjectProperty,l=h.JSON,m=g.ARRAY,n=g.BOOLEAN,o=g.DATETIME,p=g.INTEGER,q=g.OBJECT,r=g.PICKLIST,s=g.STRING,t=i.POST,u=function(a){for(var b,c,d=/<([^>]+)>/g;null!==(b=d.exec(a));){var e=b[1],f=b.input,g=c?c.replace(b[0],""):f.replace(b[0],""),h=e.split("|");if(1==h.length){if("@"===e.charAt(0))c=g.substr(0,b.index)+e+g.substr(b.index);else if("http"===e.substring(0,4)){var i='<a href="'+h[0]+'" target=_blank>'+h[0]+"</a>";c=g.substr(0,b.index)+i+g.substr(b.index)}}else if(2==h.length)if("@"===e.charAt(0)){var j="@"+h[1];c=g.substr(0,b.index)+j+g.substr(b.index)}else if("#"===e.charAt(0)){var k="#"+h[1];c=g.substr(0,b.index)+k+g.substr(b.index)}}return c||a},v=function(a){var c=[{id:"type",label:"Type",displaytype:s,inlineHelpText:"What type of message is it.",accessible:!0,createable:!1,editable:!1},{id:"ts",label:"Time Sent",displaytype:s,inlineHelpText:"When the message was sent.",accessible:!0,createable:!1,editable:!1,isUTCDate:!0,omittable:!1},{id:"user",label:"User",displaytype:s,inlineHelpText:"The user ID of the user who sent the message.",idField:!0,accessible:!0,createable:!1,editable:!1},{id:"username",label:"Username",displaytype:s,inlineHelpText:"The username of the user who sent the message.",accessible:!0,createable:!1,editable:!1,omittable:!0,defer:!0,path:"user.name"},{id:"userRealName",label:"User's Real Name",displaytype:s,inlineHelpText:"The full name of the user who sent the message.",accessible:!0,createable:!1,editable:!1,omittable:!0,defer:!0,path:"user.real_name"},{id:"text",label:"Text",displaytype:s,inlineHelpText:"The body of the message.",accessible:!0,createable:!0,editable:!0,omittable:!1}];return a&&(c=b.merge(c,a)),c},w=function(a,b){var c={};return d(a,function(a,d){d.inactive||(c[d.sourceParam||d.name]=encodeURI(j.mergeAsTextInContext(d.value,b)))}),c},x=function(a,b){var c=a.model,d=w(c.conditions,a),e=k(c,"extensions.rest.entityName"),f=["channelmessage","groupmessage","immessage"];d.__default_searchbox?-1!==f.indexOf(e)&&(a.request.url="/search.messages?token="+b.access_token+"&query="+encodeURI(d.__default_searchbox)+"&count=500",a.method.pathToContent="messages.matches"):-1!==f.indexOf(e)&&(a.method.pathToContent="messages")};e.getDataSourceType("Slack")||new e.core.RESTDataSourceTypeBase({name:"Slack",coerceRequest:function(a){var b=a.model,c=a.type,d=b.dataSource?b.dataSource:e.getDataSource(b.dataSourceName),f=d.authentication.responseBody||"";-1===a.request.url.indexOf("token=")&&(-1===a.request.url.indexOf("?")?a.request.url+="?token="+f.access_token:a.request.url+="&token="+f.access_token),"query"===c&&x(a,f),"update"!==c&&"delete"!==c||!a.row.ts||(a.row.ts=a.row.tsInUTC)},getEntityList:function(a){var d=b.Deferred(),e=this.prop("x-metadata");return d.resolve(c(e,function(b,c){return b.hidden&&!a.ignoreHidden?void 0:{value:c,label:b.label}})).promise()},queryEntityMetadata:function(a){var c=this.getEntityMetadataCacheKey(a),d=this.prop("x-metadata")[c];return b.Deferred().resolve(d)},coerceInsertResultObject:function(a){a.record.hasOwnProperty("text")&&(a.record.text=decodeURIComponent(a.record.text)),a.record.type="message"},parseSuccessfulLoadResponse:function(a,b,c){var e="string"==typeof a.body?JSON.parse(a.body):a.body,f=b.pathToContent,g=f?k(e,f):e;c.data=g,d(c.fields,function(a,b){b.hasOwnProperty("isUTCDate")&&c.data&&d(c.data,function(a,b){b.hasOwnProperty("created")?b.created=new Date(1e3*b.created).toLocaleString():b.hasOwnProperty("ts")&&(b.tsInUTC=b.ts,b.ts=new Date(1e3*b.ts).toLocaleString())})}),g&&d(g,function(a,b){b.hasOwnProperty("text")&&(b.text=u(b.text))})},parseSuccessfulSaveResponse:function(a){var b="string"==typeof a.body?JSON.parse(a.body):a.body;b.ts=new Date(1e3*b.ts).toLocaleString(),a.body=JSON.stringify(b)},onDataSourceChange:function(a){a.attr("deferfieldrendering",!0)},extendedProperties:{composer:{unomittableFields:!0},hasDefaultSearch:!0,canServerSearch:!0,hasGlobalSearchEntities:!0,"x-metadata":{Channel:{idFields:["id"],nameField:"name",label:"Channel",labelPlural:"Channels",fields:[{id:"id",label:"Id",displaytype:s,inlineHelpText:"Identifier of the channel.",accessible:!0,createable:!1,editable:!1},{id:"name",label:"Name",displaytype:s,inlineHelpText:"Name of the channel.",accessible:!0,createable:!0,editable:!0},{id:"created",label:"Created",displaytype:o,inlineHelpText:"Date and time the channel was created.",accessible:!0,createable:!1,editable:!1,isUTCDate:!0},{id:"creator",label:"Creator",displaytype:q,inlineHelpText:"Creator of the channel.",accessible:!0,createable:!1,editable:!1},{id:"is_archived",label:"Is Archived",displaytype:n,inlineHelpText:"Whether the channel is archived.",accessible:!0,createable:!1,editable:!1},{id:"is_general",label:"Is General",displaytype:n,inlineHelpText:"Whether the channel is general.",accessible:!0,createable:!0,editable:!1},{id:"is_member",label:"Is Member",displaytype:n,inlineHelpText:"Whether the current user is a member of the channel.",accessible:!0,createable:!0,editable:!1},{id:"is_starred",label:"Is Starred",displaytype:n,inlineHelpText:"Whether the channel is starred.",accessible:!0,createable:!0,editable:!1},{id:"members",label:"Members",displaytype:m,inlineHelpText:"A list of all the members of the channel.",accessible:!0,createable:!0,editable:!1},{id:"topic",label:"Topic",displaytype:q,inlineHelpText:"The topic of the channel.",accessible:!0,createable:!0,editable:!1},{id:"purpose",label:"Purpose",displaytype:q,inlineHelpText:"The purpose of the channel.",accessible:!0,createable:!0,editable:!1},{id:"last_read",label:"Last Read",displaytype:s,inlineHelpText:"Last message in the channel the user has read.",accessible:!0,createable:!0,editable:!1},{id:"unread_count",label:"Unread Count",displaytype:p,inlineHelpText:"Number of messages the user has not read, yet.",accessible:!0,createable:!0,editable:!1},{id:"unread_count_display",label:"Unread Count Display",displaytype:n,inlineHelpText:"Number of messages the user has not read, yet.",accessible:!0,createable:!0,editable:!1}],methods:{query:{url:"/channels.list",verb:t,scopes:[],contentType:l,pathToContent:"channels"},insert:{url:"/channels.create?name={{name}}",verb:t,scopes:[],contentType:l,receiveDataAs:"recordinbody",successIf:"responsefieldispresent",successField:"ok",successValue:"true"},update:{url:"/channels.rename?channel={{id}}&name={{name}}",verb:t,scopes:[],contentType:l,receiveDataAs:"recordinbody",successIf:"responsefieldispresent",successField:"ok",successValue:"true"},"delete":{url:"/channels.archive?channel={{id}}",verb:t,scopes:[],contentType:l,successIf:"responsefieldispresent",successField:"ok",successValue:"true"}}},ChannelMessage:{label:"Channel Message",labelPlural:"Channel Messages",noIdField:!0,fields:v(),methods:{query:{url:"/channels.history?channel={{channel}}",verb:t,scopes:[],contentType:l,pathToContent:"messages",additionalRequests:[{url:"/users.info?user={{user}}",verb:t,scopes:[],contentType:l,pathToContent:"user",fields:["username","userRealName"]}]},insert:{url:"/chat.meMessage?channel={{channel}}&text={{text}}",verb:t,scopes:[],contentType:l,receiveDataAs:"recordinbody",successIf:"responsefieldispresent",successField:"ok",successValue:"true"},update:{url:"/chat.update?ts={{ts}}&channel={{channel}}&text={{text}}",verb:t,scopes:[],contentType:l,receiveDataAs:"recordinbody",successIf:"responsefieldispresent",successField:"ok",successValue:"true"},"delete":{url:"/chat.delete?ts={{ts}}&channel={{channel}}",verb:t,scopes:[],contentTYpe:l,receiveDataAs:"recordinbody",successIf:"responsefieldispresent",successField:"ok",successValue:"true"}},defaultConditions:[{sourcetype:"param",sourceparam:"channel",name:"channel",label:"Channel ID",state:"filterablerequired",type:"fieldvalue",required:!0,value:""}]},Group:{idFields:["id"],nameField:"name",label:"Group",labelPlural:"Groups",fields:[{id:"id",label:"Id",displaytype:s,inlineHelpText:"Identifier of the group (private channel).",accessible:!0,createable:!1,editable:!1,omittable:!1},{id:"name",label:"Name",displaytype:s,inlineHelpText:"Name of the group (private channel).",accessible:!0,createable:!0,editable:!0},{id:"is_group",label:"Is Group",displaytype:n,inlineHelpText:"Whether or not the group is a group(?).",accessible:!0,createable:!0,editable:!1},{id:"created",label:"Created",displaytype:p,inlineHelpText:"When the private channel was created.",accessible:!0,createable:!1,editable:!1},{id:"creator",label:"Creator",displaytype:s,inlineHelpText:"The user that created the private channel.",accessible:!0,createable:!1,editable:!1},{id:"is_archived",label:"Is Archived",displaytype:n,inlineHelpText:"Whether or not the private channel is archived.",accessible:!0,createable:!0,editable:!0},{id:"is_mpim",label:"Is Multi-Party IM",displaytype:n,inlineHelpText:"Whether or not the channel is a multi-party IM.",accessible:!0,createable:!0,editable:!0},{id:"members",label:"Members",displaytype:r,inlineHelpText:"The users in the private channel..",accessible:!0,createable:!0,editable:!0},{id:"topic",label:"Topic",displaytype:q,inlineHelpText:"The topic of the channel.",accessible:!0,createable:!0,editable:!0},{id:"purpose",label:"Purpose",displaytype:q,inlineHelpText:"The purpose of the channel.",accessible:!0,createable:!0,editable:!0}],methods:{query:{url:"/groups.list",verb:t,scopes:[],contentType:l,pathToContent:"groups"},insert:{url:"/groups.create?name={{name}}",verb:t,scopes:[],contentType:l,receiveDataAs:"recordinbody",successIf:"responsefieldispresent",successField:"ok",successValue:"true"},update:{url:"/groups.rename?channel={{id}}&name={{name}}",verb:t,scopes:[],contentType:l,receiveDataAs:"recordinbody",successIf:"responsefieldispresent",successField:"ok",successValue:"true"},"delete":{url:"/groups.archive?channel={{id}}",verb:t,scopes:[],contentType:l,successIf:"responsefieldispresent",successField:"ok",successValue:"true"}}},GroupMessage:{label:"Group Message",labelPlural:"Group Messages",noIdField:!0,fields:v(),methods:{query:{url:"/groups.history?channel={{group}}",verb:t,scopes:[],contentType:l,pathToContent:"messages",additionalRequests:[{id:"users",url:"/users.info?user={{user}}",verb:t,scopes:[],contentType:l,pathToContent:"user",fields:["username","userRealName"]}]},insert:{url:"/chat.meMessage?channel={{group}}&text={{text}}",verb:t,scopes:[],contentType:l,receiveDataAs:"recordinbody",successIf:"responsefieldispresent",successField:"ok",successValue:"true"},update:{url:"/chat.update?ts={{ts}}&channel={{group}}&text={{text}}",verb:t,scopes:[],contentType:l,receiveDataAs:"recordinbody",successIf:"responsefieldispresent",successField:"ok",successValue:"true"},"delete":{url:"/chat.delete?ts={{ts}}&channel={{group}}",verb:t,scopes:[],contentTYpe:l,receiveDataAs:"recordinbody",successIf:"responsefieldispresent",successField:"ok",successValue:"true"}},defaultConditions:[{sourcetype:"param",sourceparam:"group",name:"channel",label:"Group ID",state:"filterablerequired",type:"fieldvalue",required:!0,value:""}]},InstantMessage:{idFields:["id"],label:"IM",labelPlural:"IMs",fields:[{id:"id",label:"Id",displaytype:s,inlineHelpText:"Identifier of the IM.",accessible:!0,createable:!1,editable:!1},{id:"user",label:"User",displaytype:s,inlineHelpText:"The user in the IM.",accessible:!0,createable:!0,editable:!1},{id:"created",label:"Created",displaytype:p,inlineHelpText:"When the IM was created.",accessible:!0,createable:!1,editable:!1,isUTCDate:!0},{id:"is_im",label:"Is IM",displaytype:n,inlineHelpText:"Whether or not this is an IM.",accessible:!0,createable:!0,editable:!1},{id:"is_org_shared",label:"Is Org Shared",displaytype:n,inlineHelpText:"Im not sure what this is.",accessible:!0,createable:!1,editable:!1},{id:"is_user_deleted",label:"Is User Deleted",displaytype:n,inlineHelpText:"Whether or not the user in the IM is deleted.",accessible:!0,createable:!1,editable:!1}],methods:{query:{url:"/im.list",verb:t,scopes:[],contentType:l,pathToContent:"ims"}}},IMMessage:{label:"IM Message",labelPlural:"IM Messages",noIdField:!0,fields:v(),methods:{query:{url:"/im.history?channel={{im}}",verb:t,scopes:[],contentType:l,pathToContent:"messages",additionalRequests:[{id:"users",url:"/users.info?user={{user}}",verb:t,scopes:[],contentType:l,pathToContent:"user",fields:["username","userRealName"]}]},insert:{url:"/chat.meMessage?channel={{im}}&text={{text}}",verb:t,scopes:[],contentType:l,receiveDataAs:"recordinbody",successIf:"responsefieldispresent",successField:"ok",successValue:"true"},update:{url:"/chat.update?ts={{ts}}&channel={{im}}&text={{text}}",verb:t,scopes:[],contentType:l,receiveDataAs:"recordinbody",successIf:"responsefieldispresent",successField:"ok",successValue:"true"},"delete":{url:"/chat.delete?ts={{ts}}&channel={{im}}",verb:t,scopes:[],contentTYpe:l,receiveDataAs:"recordinbody",successIf:"responsefieldispresent",successField:"ok",successValue:"true"}},defaultConditions:[{sourcetype:"param",sourceparam:"im",name:"channel",label:"IM ID",state:"filterablerequired",type:"fieldvalue",required:!0,value:""}]},User:{idFields:["id"],nameField:"name",label:"User",labelPlural:"Users",fields:[{id:"id",label:"Id",displaytype:s,inlineHelpText:"Identifier of the user.",accessible:!0,createable:!1,editable:!1},{id:"team_id",label:"Team Id",displaytype:s,inlineHelpText:"Identifier of the team.",accessible:!0,createable:!1,editable:!1},{id:"name",label:"Name",displaytype:s,inlineHelpText:"Username of the user.",accessible:!0,createable:!0,editable:!1},{id:"deleted",label:"Deleted",displaytype:n,inlineHelpText:"Whether or not the user is deleted.",accessible:!0,createable:!1,editable:!1},{id:"status",label:"Status",displaytype:s,inlineHelpText:"Status of the user.",accessible:!0,createable:!1,editable:!1},{id:"color",label:"Color",displaytype:s,inlineHelpText:"Color of the user (Hexkey without #).",accessible:!0,createable:!0,editable:!1},{id:"real_name",label:"Real Name",displaytype:s,inlineHelpText:"Name of the user.",accessible:!0,createable:!0,editable:!1},{id:"tz",label:"Time Zone",displaytype:s,inlineHelpText:"The time zone the user is in.",accessible:!0,createable:!0,editable:!1},{id:"tz_label",label:"Time Zone Label",displaytype:s,inlineHelpText:"Time Zone label.",accessible:!0,createable:!0,editable:!1},{id:"tz_offset",label:"Time Zone Offset",displaytype:p,inlineHelpText:"Time Zone Offset.",accessible:!0,createable:!1,editable:!1},{id:"profile",label:"Profile",displaytype:q,inlineHelpText:"Profile information about the user.",accessible:!0,createable:!0,editable:!1},{id:"is_admin",label:"Is Admin",displaytype:n,inlineHelpText:"Whether or not the user is an admin.",accessible:!0,createable:!0,editable:!1},{id:"is_owner",label:"Is Owner",displaytype:n,inlineHelpText:"Whether or not the user is an owner.",accessible:!0,createable:!0,editable:!1},{id:"is_primary_owner",label:"Is Primary Owner",displaytype:n,inlineHelpText:"Whether or not the user is a primary owner.",accessible:!0,createable:!0,editable:!1},{id:"is_restricted",label:"Is Restricted",displaytype:n,inlineHelpText:"Whether or not the user is restricted.",accessible:!0,createable:!0,editable:!1},{id:"is_ultra_restricted",label:"Is Ultra Restricted",displaytype:n,inlineHelpText:"Whether or not the user is ultra restricted.",accessible:!0,createable:!0,editable:!1},{id:"is_bot",label:"Is Bot",displaytype:n,inlineHelpText:"Whether or not the user is a bot.",accessible:!0,createable:!0,editable:!1}],methods:{query:{url:"/users.list",verb:t,scopes:[],contentType:l,pathToContent:"members"}}},Message:{label:"Message",labelPlural:"Messages",hidden:!0,noIdField:!0,fields:v([{id:"team",label:"Team",displaytype:s,inlineHelpText:"The team id.",accessible:!0,createable:!1,editable:!1}]),methods:{query:{url:"/search.messages?query={{search}}",verb:t,scopes:[],contentType:l,pathToContent:"messages.matches"},search:{url:"/search.messages?query={{search}}",verb:t,scopes:[],contentType:l,pathToContent:"messages.matches"}}}}}})}(skuid);